(function(){var a,b,c,d,e,f,g,h;h=typeof exports!="undefined"&&exports!==null?exports:window,h.Node=a=function(){function a(a,b,c){this.x=a,this.y=b,this.intersect=c!=null?c:!1,this.entry=!1,this.visited=!1}return a.name="Node",a.prototype.onLine=function(b,c){var d,e,f,g;return f=new a(c.x-b.x,c.y-b.y),g=new a(this.x-b.x,this.y-b.y),d=f.x*f.x+f.y*f.y,d===0?this.x===b.x&&this.y===b.y:(e=(f.x*this.x+f.y*this.y)/d,e>=0&&e<=1)},a.prototype.toString=function(){return""+this.x+","+this.y},a}(),Array.prototype.nextFromIndex=function(a){return this[a+1===this.length?0:a+1]},Array.prototype.prevFromIndex=function(a){return this[a-1===-1?this.length-1:a-1]},Array.prototype.nextFrom=function(a){var b,c;b=this[c=0];while(b.x!==a.x||b.y!==a.y)c++,b=this[c];return this.nextFromIndex(c)},Array.prototype.prevFrom=function(a){var b,c;b=this[c=0];while(b.x!==a.x||b.y!==a.y)c++,b=this[c];return this.prevFromIndex(c)},h.NodeArray=b=Array,h.doesIntersect=d=function(b,c,d,e){var f,g,h,i,j,k;return f=(e.y-d.y)*(c.x-b.x)-(e.x-d.x)*(c.y-b.y),f===0?!1:(h=((e.x-d.x)*(b.y-d.y)-(e.y-d.y)*(b.x-d.x))/f,i=((c.x-b.x)*(b.y-d.y)-(c.y-b.y)*(b.x-d.x))/f,j=b.x+h*(c.x-b.x),k=b.y+h*(c.y-b.y),g=new a(j,k,!0),0<=h&&h<=1&&0<=i&&i<=1?g:!1)},h.norm=g=function(a,b){return Math.sqrt((b.x-a.x)*(b.x-a.x)+(b.y-a.y)*(b.y-a.y))},h.containmentTest=c=function(b,c){var e,f,g,h,i,j,k;f=new a(0,b.y),i=0;for(e=j=0,k=c.length;j<k;e=++j)h=c[e],g=c[e<c.length-1?e+1:0],d(f,b,h,g)&&i++;return!!(i%2)},h.markIntersects=f=function(b,c){var e,f,g,h,i,j,k,l,m,n,o,p;p=[];for(k=n=0,o=b.length;n<o;k=++n)l=b[k],l.intersect?p.push(void 0):p.push(function(){var l,n,o;o=[];for(e=l=0,n=c.length;l<n;e=++l){f=c[e];if(!f.intersect){h=k+1===b.length?-k:1;while(b[k+h].intersect)h++,k+h===b.length&&(h=-k);i=e+1===c.length?-e:1;while(c[e+i].intersect)i++,e+i===c.length&&(i=-e);j=d(b[k],b[k+h],c[e],c[e+i]),j?(m=new a(j.x,j.y,!0),g=new a(j.x,j.y,!0),m.neighbour=g,g.neighbour=m,b.splice(k+1,0,m),o.push(c.splice(e+1,0,g))):o.push(void 0)}else o.push(void 0)}return o}());return p},h.markEntryPoints=e=function(a,b,d){var e,f,g,h,i;d==null&&(d=!1),e=c(a[0],b),d&&(e=!e),i=[];for(g=0,h=b.length;g<h;g++)f=b[g],f.intersect?(f.entry=e,i.push(e=!e)):i.push(void 0);return i},Raphael.fn.clip=function(a,b){var c,d,g,h;a=a.toNodes(),b=b.toNodes(),f(a,b),e(a,b),e(b,a),c=a,d=c[0],h=[],g=!0;while(d.entry!==!0)d=c.nextFrom(d);d.visited=!0;for(;;){h.push(d),d.intersect&&(d=d.neighbour,c=c===a?b:a,g=d.entry),g?d=c.nextFrom(d):d=c.prevFrom(d),d.visited=!0;if(d===h[0])break}return paper.path("M"+h.join("L")+"Z")},Raphael.fn.join=function(a,b){},Raphael.st.clip=function(){var a,b,c,d,e,f,g,h,i,j;f=0,a=1,g=this[f].toNodes(),b=this[a].toNodes(),d=paper.clip(g,b);if(this.length>2){j=this.splice(0,2);for(h=0,i=j.length;h<i;h++)c=j[h],b=c.toNodes(),d=paper.path("M"+d.join("L")+"Z").toNodes(),d=paper.clip(d,b)}return d?e=paper.path("M"+d.join("L")+"Z"):!1},Raphael.st.join=function(){},Raphael.el.toNodes=function(){var c,d,e,f,g,h,i,j,k,l;if(this.attr("path")==="")return!1;f=Raphael.parsePathString(this.attr("path")),e=new b;for(i=0,k=f.length;i<k;i++)h=f[i],h[0]!=="Z"&&e.push(new a(h[1],h[2]));g=0;for(j=0,l=e.length;j<l;j++)d=e[j],c=e.nextFrom(d),g+=(c.x-d.x)*(c.y+d.y);return g>0&&e.reverse(),e}}).call(this)