define(function(){"use strict";function c(e,t,n){i.biginteger_used=1;if(e!=null)if("number"==typeof e&&"undefined"==typeof t)this.fromInt(e);else if("number"==typeof e)this.fromNumber(e,t,n);else if(t==null&&"string"!=typeof e)this.fromString(e,256);else this.fromString(e,t)}function h(){return new c(null)}function p(e,t,n,r,i,s){while(--s>=0){var o=t*this[e++]+n[r]+i;i=Math.floor(o/67108864);n[r++]=o&67108863}return i}function d(e,t,n,r,i,s){var o=t&32767,u=t>>15;while(--s>=0){var a=this[e]&32767;var f=this[e++]>>15;var l=u*a+f*o;a=o*a+((l&32767)<<15)+n[r]+(i&1073741823);i=(a>>>30)+(l>>>15)+u*f+(i>>>30);n[r++]=a&1073741823}return i}function v(e,t,n,r,i,s){var o=t&16383,u=t>>14;while(--s>=0){var a=this[e]&16383;var f=this[e++]>>14;var l=u*a+f*o;a=o*a+((l&16383)<<14)+n[r]+i;i=(a>>28)+(l>>14)+u*f;n[r++]=a&268435455}return i}function E(e){return g.charAt(e)}function S(e,t){var n=y[e.charCodeAt(t)];return n==null?-1:n}function x(e){for(var t=this.t-1;t>=0;--t)e[t]=this[t];e.t=this.t;e.s=this.s}function T(e){this.t=1;this.s=e<0?-1:0;if(e>0)this[0]=e;else if(e<-1)this[0]=e+this.DV;else this.t=0}function N(e){var t=h();t.fromInt(e);return t}function C(e,t){var n;if(t==16)n=4;else if(t==8)n=3;else if(t==256)n=8;else if(t==2)n=1;else if(t==32)n=5;else if(t==4)n=2;else{this.fromRadix(e,t);return}this.t=0;this.s=0;var r=e.length,i=false,s=0;while(--r>=0){var o=n==8?e[r]&255:S(e,r);if(o<0){if(e.charAt(r)=="-")i=true;continue}i=false;if(s==0)this[this.t++]=o;else if(s+n>this.DB){this[this.t-1]|=(o&(1<<this.DB-s)-1)<<s;this[this.t++]=o>>this.DB-s}else this[this.t-1]|=o<<s;s+=n;if(s>=this.DB)s-=this.DB}if(n==8&&(e[0]&128)!=0){this.s=-1;if(s>0)this[this.t-1]|=(1<<this.DB-s)-1<<s}this.clamp();if(i)c.ZERO.subTo(this,this)}function k(){var e=this.s&this.DM;while(this.t>0&&this[this.t-1]==e)--this.t}function L(e){if(this.s<0)return"-"+this.negate().toString(e);var t;if(e==16)t=4;else if(e==8)t=3;else if(e==2)t=1;else if(e==32)t=5;else if(e==4)t=2;else return this.toRadix(e);var n=(1<<t)-1,r,i=false,s="",o=this.t;var u=this.DB-o*this.DB%t;if(o-->0){if(u<this.DB&&(r=this[o]>>u)>0){i=true;s=E(r)}while(o>=0){if(u<t){r=(this[o]&(1<<u)-1)<<t-u;r|=this[--o]>>(u+=this.DB-t)}else{r=this[o]>>(u-=t)&n;if(u<=0){u+=this.DB;--o}}if(r>0)i=true;if(i)s+=E(r)}}return i?s:"0"}function A(){var e=h();c.ZERO.subTo(this,e);return e}function O(){return this.s<0?this.negate():this}function M(e){var t=this.s-e.s;if(t!=0)return t;var n=this.t;t=n-e.t;if(t!=0)return this.s<0?-t:t;while(--n>=0)if((t=this[n]-e[n])!=0)return t;return 0}function _(e){var t=1,n;if((n=e>>>16)!=0){e=n;t+=16}if((n=e>>8)!=0){e=n;t+=8}if((n=e>>4)!=0){e=n;t+=4}if((n=e>>2)!=0){e=n;t+=2}if((n=e>>1)!=0){e=n;t+=1}return t}function D(){if(this.t<=0)return 0;return this.DB*(this.t-1)+_(this[this.t-1]^this.s&this.DM)}function P(e,t){var n;for(n=this.t-1;n>=0;--n)t[n+e]=this[n];for(n=e-1;n>=0;--n)t[n]=0;t.t=this.t+e;t.s=this.s}function H(e,t){for(var n=e;n<this.t;++n)t[n-e]=this[n];t.t=Math.max(this.t-e,0);t.s=this.s}function B(e,t){var n=e%this.DB;var r=this.DB-n;var i=(1<<r)-1;var s=Math.floor(e/this.DB),o=this.s<<n&this.DM,u;for(u=this.t-1;u>=0;--u){t[u+s+1]=this[u]>>r|o;o=(this[u]&i)<<n}for(u=s-1;u>=0;--u)t[u]=0;t[s]=o;t.t=this.t+s+1;t.s=this.s;t.clamp()}function j(e,t){t.s=this.s;var n=Math.floor(e/this.DB);if(n>=this.t){t.t=0;return}var r=e%this.DB;var i=this.DB-r;var s=(1<<r)-1;t[0]=this[n]>>r;for(var o=n+1;o<this.t;++o){t[o-n-1]|=(this[o]&s)<<i;t[o-n]=this[o]>>r}if(r>0)t[this.t-n-1]|=(this.s&s)<<i;t.t=this.t-n;t.clamp()}function F(e,t){var n=0,r=0,i=Math.min(e.t,this.t);while(n<i){r+=this[n]-e[n];t[n++]=r&this.DM;r>>=this.DB}if(e.t<this.t){r-=e.s;while(n<this.t){r+=this[n];t[n++]=r&this.DM;r>>=this.DB}r+=this.s}else{r+=this.s;while(n<e.t){r-=e[n];t[n++]=r&this.DM;r>>=this.DB}r-=e.s}t.s=r<0?-1:0;if(r<-1)t[n++]=this.DV+r;else if(r>0)t[n++]=r;t.t=n;t.clamp()}function I(e,t){var n=this.abs(),r=e.abs();var i=n.t;t.t=i+r.t;while(--i>=0)t[i]=0;for(i=0;i<r.t;++i)t[i+n.t]=n.am(0,r[i],t,i,0,n.t);t.s=0;t.clamp();if(this.s!=e.s)c.ZERO.subTo(t,t)}function q(e){var t=this.abs();var n=e.t=2*t.t;while(--n>=0)e[n]=0;for(n=0;n<t.t-1;++n){var r=t.am(n,t[n],e,2*n,0,1);if((e[n+t.t]+=t.am(n+1,2*t[n],e,2*n+1,r,t.t-n-1))>=t.DV){e[n+t.t]-=t.DV;e[n+t.t+1]=1}}if(e.t>0)e[e.t-1]+=t.am(n,t[n],e,2*n,0,1);e.s=0;e.clamp()}function R(e,t,n){var r=e.abs();if(r.t<=0)return;var i=this.abs();if(i.t<r.t){if(t!=null)t.fromInt(0);if(n!=null)this.copyTo(n);return}if(n==null)n=h();var s=h(),o=this.s,u=e.s;var a=this.DB-_(r[r.t-1]);if(a>0){r.lShiftTo(a,s);i.lShiftTo(a,n)}else{r.copyTo(s);i.copyTo(n)}var f=s.t;var l=s[f-1];if(l==0)return;var p=l*(1<<this.F1)+(f>1?s[f-2]>>this.F2:0);var d=this.FV/p,v=(1<<this.F1)/p,m=1<<this.F2;var g=n.t,y=g-f,b=t==null?h():t;s.dlShiftTo(y,b);if(n.compareTo(b)>=0){n[n.t++]=1;n.subTo(b,n)}c.ONE.dlShiftTo(f,b);b.subTo(s,s);while(s.t<f)s[s.t++]=0;while(--y>=0){var w=n[--g]==l?this.DM:Math.floor(n[g]*d+(n[g-1]+m)*v);if((n[g]+=s.am(0,w,n,y,0,f))<w){s.dlShiftTo(y,b);n.subTo(b,n);while(n[g]<--w)n.subTo(b,n)}}if(t!=null){n.drShiftTo(f,t);if(o!=u)c.ZERO.subTo(t,t)}n.t=f;n.clamp();if(a>0)n.rShiftTo(a,n);if(o<0)c.ZERO.subTo(n,n)}function U(e){var t=h();this.abs().divRemTo(e,null,t);if(this.s<0&&t.compareTo(c.ZERO)>0)e.subTo(t,t);return t}function z(e){this.m=e}function W(e){if(e.s<0||e.compareTo(this.m)>=0)return e.mod(this.m);else return e}function X(e){return e}function V(e){e.divRemTo(this.m,null,e)}function $(e,t,n){e.multiplyTo(t,n);this.reduce(n)}function J(e,t){e.squareTo(t);this.reduce(t)}function K(){if(this.t<1)return 0;var e=this[0];if((e&1)==0)return 0;var t=e&3;t=t*(2-(e&15)*t)&15;t=t*(2-(e&255)*t)&255;t=t*(2-((e&65535)*t&65535))&65535;t=t*(2-e*t%this.DV)%this.DV;return t>0?this.DV-t:-t}function Q(e){this.m=e;this.mp=e.invDigit();this.mpl=this.mp&32767;this.mph=this.mp>>15;this.um=(1<<e.DB-15)-1;this.mt2=2*e.t}function G(e){var t=h();e.abs().dlShiftTo(this.m.t,t);t.divRemTo(this.m,null,t);if(e.s<0&&t.compareTo(c.ZERO)>0)this.m.subTo(t,t);return t}function Y(e){var t=h();e.copyTo(t);this.reduce(t);return t}function Z(e){while(e.t<=this.mt2)e[e.t++]=0;for(var t=0;t<this.m.t;++t){var n=e[t]&32767;var r=n*this.mpl+((n*this.mph+(e[t]>>15)*this.mpl&this.um)<<15)&e.DM;n=t+this.m.t;e[n]+=this.m.am(0,r,e,t,0,this.m.t);while(e[n]>=e.DV){e[n]-=e.DV;e[++n]++}}e.clamp();e.drShiftTo(this.m.t,e);if(e.compareTo(this.m)>=0)e.subTo(this.m,e)}function et(e,t){e.squareTo(t);this.reduce(t)}function tt(e,t,n){e.multiplyTo(t,n);this.reduce(n)}function nt(){return(this.t>0?this[0]&1:this.s)==0}function rt(e,t){if(e>4294967295||e<1)return c.ONE;var n=h(),r=h(),i=t.convert(this),s=_(e)-1;i.copyTo(n);while(--s>=0){t.sqrTo(n,r);if((e&1<<s)>0)t.mulTo(r,i,n);else{var o=n;n=r;r=o}}return t.revert(n)}function it(e,t){var n;if(e<256||t.isEven())n=new z(t);else n=new Q(t);return this.exp(e,n)}function st(){var e=h();this.copyTo(e);return e}function ot(){if(this.s<0){if(this.t==1)return this[0]-this.DV;else if(this.t==0)return-1}else if(this.t==1)return this[0];else if(this.t==0)return 0;return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]}function ut(){return this.t==0?this.s:this[0]<<24>>24}function at(){return this.t==0?this.s:this[0]<<16>>16}function ft(e){return Math.floor(Math.LN2*this.DB/Math.log(e))}function lt(){if(this.s<0)return-1;else if(this.t<=0||this.t==1&&this[0]<=0)return 0;else return 1}function ct(e){if(e==null)e=10;if(this.signum()==0||e<2||e>36)return"0";var t=this.chunkSize(e);var n=Math.pow(e,t);var r=N(n),i=h(),s=h(),o="";this.divRemTo(r,i,s);while(i.signum()>0){o=(n+s.intValue()).toString(e).substr(1)+o;i.divRemTo(r,i,s)}return s.intValue().toString(e)+o}function ht(e,t){this.fromInt(0);if(t==null)t=10;var n=this.chunkSize(t);var r=Math.pow(t,n),i=false,s=0,o=0;for(var u=0;u<e.length;++u){var a=S(e,u);if(a<0){if(e.charAt(u)=="-"&&this.signum()==0)i=true;continue}o=t*o+a;if(++s>=n){this.dMultiply(r);this.dAddOffset(o,0);s=0;o=0}}if(s>0){this.dMultiply(Math.pow(t,s));this.dAddOffset(o,0)}if(i)c.ZERO.subTo(this,this)}function pt(e,t,n){if("number"==typeof t){if(e<2)this.fromInt(1);else{this.fromNumber(e,n);if(!this.testBit(e-1))this.bitwiseTo(c.ONE.shiftLeft(e-1),Et,this);if(this.isEven())this.dAddOffset(1,0);while(!this.isProbablePrime(t)){this.dAddOffset(2,0);if(this.bitLength()>e)this.subTo(c.ONE.shiftLeft(e-1),this)}}}else{var r=new Array,i=e&7;r.length=(e>>3)+1;t.nextBytes(r);if(i>0)r[0]&=(1<<i)-1;else r[0]=0;this.fromString(r,256)}}function dt(){var e=this.t,t=new Array;t[0]=this.s;var n=this.DB-e*this.DB%8,r,i=0;if(e-->0){if(n<this.DB&&(r=this[e]>>n)!=(this.s&this.DM)>>n)t[i++]=r|this.s<<this.DB-n;while(e>=0){if(n<8){r=(this[e]&(1<<n)-1)<<8-n;r|=this[--e]>>(n+=this.DB-8)}else{r=this[e]>>(n-=8)&255;if(n<=0){n+=this.DB;--e}}if((r&128)!=0)r|=-256;if(i==0&&(this.s&128)!=(r&128))++i;if(i>0||r!=this.s)t[i++]=r}}return t}function vt(e){return this.compareTo(e)==0}function mt(e){return this.compareTo(e)<0?this:e}function gt(e){return this.compareTo(e)>0?this:e}function yt(e,t,n){var r,i,s=Math.min(e.t,this.t);for(r=0;r<s;++r)n[r]=t(this[r],e[r]);if(e.t<this.t){i=e.s&this.DM;for(r=s;r<this.t;++r)n[r]=t(this[r],i);n.t=this.t}else{i=this.s&this.DM;for(r=s;r<e.t;++r)n[r]=t(i,e[r]);n.t=e.t}n.s=t(this.s,e.s);n.clamp()}function bt(e,t){return e&t}function wt(e){var t=h();this.bitwiseTo(e,bt,t);return t}function Et(e,t){return e|t}function St(e){var t=h();this.bitwiseTo(e,Et,t);return t}function xt(e,t){return e^t}function Tt(e){var t=h();this.bitwiseTo(e,xt,t);return t}function Nt(e,t){return e&~t}function Ct(e){var t=h();this.bitwiseTo(e,Nt,t);return t}function kt(){var e=h();for(var t=0;t<this.t;++t)e[t]=this.DM&~this[t];e.t=this.t;e.s=~this.s;return e}function Lt(e){var t=h();if(e<0)this.rShiftTo(-e,t);else this.lShiftTo(e,t);return t}function At(e){var t=h();if(e<0)this.lShiftTo(-e,t);else this.rShiftTo(e,t);return t}function Ot(e){if(e==0)return-1;var t=0;if((e&65535)==0){e>>=16;t+=16}if((e&255)==0){e>>=8;t+=8}if((e&15)==0){e>>=4;t+=4}if((e&3)==0){e>>=2;t+=2}if((e&1)==0)++t;return t}function Mt(){for(var e=0;e<this.t;++e)if(this[e]!=0)return e*this.DB+Ot(this[e]);if(this.s<0)return this.t*this.DB;return-1}function _t(e){var t=0;while(e!=0){e&=e-1;++t}return t}function Dt(){var e=0,t=this.s&this.DM;for(var n=0;n<this.t;++n)e+=_t(this[n]^t);return e}function Pt(e){var t=Math.floor(e/this.DB);if(t>=this.t)return this.s!=0;return(this[t]&1<<e%this.DB)!=0}function Ht(e,t){var n=c.ONE.shiftLeft(e);this.bitwiseTo(n,t,n);return n}function Bt(e){return this.changeBit(e,Et)}function jt(e){return this.changeBit(e,Nt)}function Ft(e){return this.changeBit(e,xt)}function It(e,t){var n=0,r=0,i=Math.min(e.t,this.t);while(n<i){r+=this[n]+e[n];t[n++]=r&this.DM;r>>=this.DB}if(e.t<this.t){r+=e.s;while(n<this.t){r+=this[n];t[n++]=r&this.DM;r>>=this.DB}r+=this.s}else{r+=this.s;while(n<e.t){r+=e[n];t[n++]=r&this.DM;r>>=this.DB}r+=e.s}t.s=r<0?-1:0;if(r>0)t[n++]=r;else if(r<-1)t[n++]=this.DV+r;t.t=n;t.clamp()}function qt(e){var t=h();this.addTo(e,t);return t}function Rt(e){var t=h();this.subTo(e,t);return t}function Ut(e){var t=h();this.multiplyTo(e,t);return t}function zt(){var e=h();this.squareTo(e);return e}function Wt(e){var t=h();this.divRemTo(e,t,null);return t}function Xt(e){var t=h();this.divRemTo(e,null,t);return t}function Vt(e){var t=h(),n=h();this.divRemTo(e,t,n);return new Array(t,n)}function $t(e){this[this.t]=this.am(0,e-1,this,0,0,this.t);++this.t;this.clamp()}function Jt(e,t){if(e==0)return;while(this.t<=t)this[this.t++]=0;this[t]+=e;while(this[t]>=this.DV){this[t]-=this.DV;if(++t>=this.t)this[this.t++]=0;++this[t]}}function Kt(){}function Qt(e){return e}function Gt(e,t,n){e.multiplyTo(t,n)}function Yt(e,t){e.squareTo(t)}function Zt(e){return this.exp(e,new Kt)}function en(e,t,n){var r=Math.min(this.t+e.t,t);n.s=0;n.t=r;while(r>0)n[--r]=0;var i;for(i=n.t-this.t;r<i;++r)n[r+this.t]=this.am(0,e[r],n,r,0,this.t);for(i=Math.min(e.t,t);r<i;++r)this.am(0,e[r],n,r,0,t-r);n.clamp()}function tn(e,t,n){--t;var r=n.t=this.t+e.t-t;n.s=0;while(--r>=0)n[r]=0;for(r=Math.max(t-this.t,0);r<e.t;++r)n[this.t+r-t]=this.am(t-r,e[r],n,0,0,this.t+r-t);n.clamp();n.drShiftTo(1,n)}function nn(e){this.r2=h();this.q3=h();c.ONE.dlShiftTo(2*e.t,this.r2);this.mu=this.r2.divide(e);this.m=e}function rn(e){if(e.s<0||e.t>2*this.m.t)return e.mod(this.m);else if(e.compareTo(this.m)<0)return e;else{var t=h();e.copyTo(t);this.reduce(t);return t}}function sn(e){return e}function on(e){e.drShiftTo(this.m.t-1,this.r2);if(e.t>this.m.t+1){e.t=this.m.t+1;e.clamp()}this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3);this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);while(e.compareTo(this.r2)<0)e.dAddOffset(1,this.m.t+1);e.subTo(this.r2,e);while(e.compareTo(this.m)>=0)e.subTo(this.m,e)}function un(e,t){e.squareTo(t);this.reduce(t)}function an(e,t,n){e.multiplyTo(t,n);this.reduce(n)}function fn(e,t){var n=e.bitLength(),r,i=N(1),s;if(n<=0)return i;else if(n<18)r=1;else if(n<48)r=3;else if(n<144)r=4;else if(n<768)r=5;else r=6;if(n<8)s=new z(t);else if(t.isEven())s=new nn(t);else s=new Q(t);var o=new Array,u=3,a=r-1,f=(1<<r)-1;o[1]=s.convert(this);if(r>1){var l=h();s.sqrTo(o[1],l);while(u<=f){o[u]=h();s.mulTo(l,o[u-2],o[u]);u+=2}}var c=e.t-1,p,d=true,v=h(),m;n=_(e[c])-1;while(c>=0){if(n>=a)p=e[c]>>n-a&f;else{p=(e[c]&(1<<n+1)-1)<<a-n;if(c>0)p|=e[c-1]>>this.DB+n-a}u=r;while((p&1)==0){p>>=1;--u}if((n-=u)<0){n+=this.DB;--c}if(d){o[p].copyTo(i);d=false}else{while(u>1){s.sqrTo(i,v);s.sqrTo(v,i);u-=2}if(u>0)s.sqrTo(i,v);else{m=i;i=v;v=m}s.mulTo(v,o[p],i)}while(c>=0&&(e[c]&1<<n)==0){s.sqrTo(i,v);m=i;i=v;v=m;if(--n<0){n=this.DB-1;--c}}}return s.revert(i)}function ln(e){var t=this.s<0?this.negate():this.clone();var n=e.s<0?e.negate():e.clone();if(t.compareTo(n)<0){var r=t;t=n;n=r}var i=t.getLowestSetBit(),s=n.getLowestSetBit();if(s<0)return t;if(i<s)s=i;if(s>0){t.rShiftTo(s,t);n.rShiftTo(s,n)}while(t.signum()>0){if((i=t.getLowestSetBit())>0)t.rShiftTo(i,t);if((i=n.getLowestSetBit())>0)n.rShiftTo(i,n);if(t.compareTo(n)>=0){t.subTo(n,t);t.rShiftTo(1,t)}else{n.subTo(t,n);n.rShiftTo(1,n)}}if(s>0)n.lShiftTo(s,n);return n}function cn(e){if(e<=0)return 0;var t=this.DV%e,n=this.s<0?e-1:0;if(this.t>0)if(t==0)n=this[0]%e;else for(var r=this.t-1;r>=0;--r)n=(t*n+this[r])%e;return n}function hn(e){var t=e.isEven();if(this.isEven()&&t||e.signum()==0)return c.ZERO;var n=e.clone(),r=this.clone();var i=N(1),s=N(0),o=N(0),u=N(1);while(n.signum()!=0){while(n.isEven()){n.rShiftTo(1,n);if(t){if(!i.isEven()||!s.isEven()){i.addTo(this,i);s.subTo(e,s)}i.rShiftTo(1,i)}else if(!s.isEven())s.subTo(e,s);s.rShiftTo(1,s)}while(r.isEven()){r.rShiftTo(1,r);if(t){if(!o.isEven()||!u.isEven()){o.addTo(this,o);u.subTo(e,u)}o.rShiftTo(1,o)}else if(!u.isEven())u.subTo(e,u);u.rShiftTo(1,u)}if(n.compareTo(r)>=0){n.subTo(r,n);if(t)i.subTo(o,i);s.subTo(u,s)}else{r.subTo(n,r);if(t)o.subTo(i,o);u.subTo(s,u)}}if(r.compareTo(c.ONE)!=0)return c.ZERO;if(u.compareTo(e)>=0)return u.subtract(e);if(u.signum()<0)u.addTo(e,u);else return u;if(u.signum()<0)return u.add(e);else return u}function vn(e){var t,n=this.abs();if(n.t==1&&n[0]<=pn[pn.length-1]){for(t=0;t<pn.length;++t)if(n[0]==pn[t])return true;return false}if(n.isEven())return false;t=1;while(t<pn.length){var r=pn[t],i=t+1;while(i<pn.length&&r<dn)r*=pn[i++];r=n.modInt(r);while(t<i)if(r%pn[t++]==0)return false}return n.millerRabin(e)}function mn(e){var t=this.subtract(c.ONE);var n=t.getLowestSetBit();if(n<=0)return false;var r=t.shiftRight(n);e=e+1>>1;if(e>pn.length)e=pn.length;var i=h();for(var s=0;s<e;++s){i.fromInt(pn[Math.floor(Math.random()*pn.length)]);var o=i.modPow(r,this);if(o.compareTo(c.ONE)!=0&&o.compareTo(t)!=0){var u=1;while(u++<n&&o.compareTo(t)!=0){o=o.modPowInt(2,this);if(o.compareTo(c.ONE)==0)return false}if(o.compareTo(t)!=0)return false}}return true}var e=false;var t=false;var n=true;var r=false;var i={};var s="chrome";var o="Netscape";var u={};if(s.indexOf("chrome")!=-1&&s.indexOf("chromium")==-1)u.chrome=1;else u.chrome=0;if(s.indexOf("chromium")!=-1)u.chromium=1;else u.chromium=0;if(s.indexOf("safari")!=-1&&s.indexOf("chrome")==-1&&s.indexOf("chromium")==-1)u.safari=1;else u.safari=0;if(s.indexOf("firefox")!=-1)u.firefox=1;else u.firefox=0;if(s.indexOf("firefox/17")!=-1)u.firefox17=1;else u.firefox17=0;if(s.indexOf("firefox/15")!=-1)u.firefox15=1;else u.firefox15=0;if(s.indexOf("firefox/3")!=-1)u.firefox3=1;else u.firefox3=0;if(s.indexOf("opera")!=-1)u.opera=1;else u.opera=0;if(s.indexOf("msie 10")!=-1)u.msie10=1;else u.msie10=0;if(s.indexOf("msie 9")!=-1)u.msie9=1;else u.msie9=0;if(s.indexOf("msie 8")!=-1)u.msie8=1;else u.msie8=0;if(s.indexOf("msie 7")!=-1)u.msie7=1;else u.msie7=0;if(s.indexOf("msie ")!=-1)u.msie=1;else u.msie=0;i.biginteger_used=null;var a;var f=0xdeadbeefcafe;var l=(f&16777215)==15715070;if(l&&o=="Microsoft Internet Explorer"){c.prototype.am=d;a=30}else if(l&&o!="Netscape"){c.prototype.am=p;a=26}else{c.prototype.am=v;a=28}c.prototype.DB=a;c.prototype.DM=(1<<a)-1;c.prototype.DV=1<<a;var m=52;c.prototype.FV=Math.pow(2,m);c.prototype.F1=m-a;c.prototype.F2=2*a-m;var g="0123456789abcdefghijklmnopqrstuvwxyz";var y=new Array;var b,w;b="0".charCodeAt(0);for(w=0;w<=9;++w)y[b++]=w;b="a".charCodeAt(0);for(w=10;w<36;++w)y[b++]=w;b="A".charCodeAt(0);for(w=10;w<36;++w)y[b++]=w;z.prototype.convert=W;z.prototype.revert=X;z.prototype.reduce=V;z.prototype.mulTo=$;z.prototype.sqrTo=J;Q.prototype.convert=G;Q.prototype.revert=Y;Q.prototype.reduce=Z;Q.prototype.mulTo=tt;Q.prototype.sqrTo=et;c.prototype.copyTo=x;c.prototype.fromInt=T;c.prototype.fromString=C;c.prototype.clamp=k;c.prototype.dlShiftTo=P;c.prototype.drShiftTo=H;c.prototype.lShiftTo=B;c.prototype.rShiftTo=j;c.prototype.subTo=F;c.prototype.multiplyTo=I;c.prototype.squareTo=q;c.prototype.divRemTo=R;c.prototype.invDigit=K;c.prototype.isEven=nt;c.prototype.exp=rt;c.prototype.toString=L;c.prototype.negate=A;c.prototype.abs=O;c.prototype.compareTo=M;c.prototype.bitLength=D;c.prototype.mod=U;c.prototype.modPowInt=it;c.ZERO=N(0);c.ONE=N(1);Kt.prototype.convert=Qt;Kt.prototype.revert=Qt;Kt.prototype.mulTo=Gt;Kt.prototype.sqrTo=Yt;nn.prototype.convert=rn;nn.prototype.revert=sn;nn.prototype.reduce=on;nn.prototype.mulTo=an;nn.prototype.sqrTo=un;var pn=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997];var dn=(1<<26)/pn[pn.length-1];c.prototype.chunkSize=ft;c.prototype.toRadix=ct;c.prototype.fromRadix=ht;c.prototype.fromNumber=pt;c.prototype.bitwiseTo=yt;c.prototype.changeBit=Ht;c.prototype.addTo=It;c.prototype.dMultiply=$t;c.prototype.dAddOffset=Jt;c.prototype.multiplyLowerTo=en;c.prototype.multiplyUpperTo=tn;c.prototype.modInt=cn;c.prototype.millerRabin=mn;c.prototype.clone=st;c.prototype.intValue=ot;c.prototype.byteValue=ut;c.prototype.shortValue=at;c.prototype.signum=lt;c.prototype.toByteArray=dt;c.prototype.equals=vt;c.prototype.min=mt;c.prototype.max=gt;c.prototype.and=wt;c.prototype.or=St;c.prototype.xor=Tt;c.prototype.andNot=Ct;c.prototype.not=kt;c.prototype.shiftLeft=Lt;c.prototype.shiftRight=At;c.prototype.getLowestSetBit=Mt;c.prototype.bitCount=Dt;c.prototype.testBit=Pt;c.prototype.setBit=Bt;c.prototype.clearBit=jt;c.prototype.flipBit=Ft;c.prototype.add=qt;c.prototype.subtract=Rt;c.prototype.multiply=Ut;c.prototype.divide=Wt;c.prototype.remainder=Xt;c.prototype.divideAndRemainder=Vt;c.prototype.modPow=fn;c.prototype.modInverse=hn;c.prototype.pow=Zt;c.prototype.gcd=ln;c.prototype.isProbablePrime=vn;c.prototype.square=zt;var gn=c;gn.prototype.IsNegative=function(){if(this.compareTo(gn.ZERO)==-1)return true;else return false};gn.op_Equality=function(e,t){if(e.compareTo(t)==0)return true;else return false};gn.op_Inequality=function(e,t){if(e.compareTo(t)!=0)return true;else return false};gn.op_GreaterThan=function(e,t){if(e.compareTo(t)>0)return true;else return false};gn.op_LessThan=function(e,t){if(e.compareTo(t)<0)return true;else return false};gn.op_Addition=function(e,t){return(new gn(e)).add(new gn(t))};gn.op_Subtraction=function(e,t){return(new gn(e)).subtract(new gn(t))};gn.Int128Mul=function(e,t){return(new gn(e)).multiply(new gn(t))};gn.op_Division=function(e,t){return e.divide(t)};gn.prototype.ToDouble=function(){return parseFloat(this.toString())};if(typeof yn=="undefined"){var yn=function(e,t){var n;if(typeof Object.getOwnPropertyNames=="undefined"){for(n in t.prototype)if(typeof e.prototype[n]=="undefined"||e.prototype[n]==Object.prototype[n])e.prototype[n]=t.prototype[n];for(n in t)if(typeof e[n]=="undefined")e[n]=t[n];e.$baseCtor=t}else{var r=Object.getOwnPropertyNames(t.prototype);for(var i=0;i<r.length;i++)if(typeof Object.getOwnPropertyDescriptor(e.prototype,r[i])=="undefined")Object.defineProperty(e.prototype,r[i],Object.getOwnPropertyDescriptor(t.prototype,r[i]));for(n in t)if(typeof e[n]=="undefined")e[n]=t[n];e.$baseCtor=t}}}i.Path=function(){return[]};i.Paths=function(){return[]};i.DoublePoint=function(){var e=arguments;this.X=0;this.Y=0;if(e.length==1){this.X=e[0].X;this.Y=e[0].Y}else if(e.length==2){this.X=e[0];this.Y=e[1]}};i.DoublePoint0=function(){this.X=0;this.Y=0};i.DoublePoint1=function(e){this.X=e.X;this.Y=e.Y};i.DoublePoint2=function(e,t){this.X=e;this.Y=t};i.PolyNode=function(){this.m_Parent=null;this.m_polygon=new i.Path;this.m_Index=0;this.m_jointype=0;this.m_endtype=0;this.m_Childs=[];this.IsOpen=false};i.PolyNode.prototype.IsHoleNode=function(){var e=true;var t=this.m_Parent;while(t!==null){e=!e;t=t.m_Parent}return e};i.PolyNode.prototype.ChildCount=function(){return this.m_Childs.length};i.PolyNode.prototype.Contour=function(){return this.m_polygon};i.PolyNode.prototype.AddChild=function(e){var t=this.m_Childs.length;this.m_Childs.push(e);e.m_Parent=this;e.m_Index=t};i.PolyNode.prototype.GetNext=function(){if(this.m_Childs.length>0)return this.m_Childs[0];else return this.GetNextSiblingUp()};i.PolyNode.prototype.GetNextSiblingUp=function(){if(this.m_Parent===null)return null;else if(this.m_Index==this.m_Parent.m_Childs.length-1)return this.m_Parent.GetNextSiblingUp();else return this.m_Parent.m_Childs[this.m_Index+1]};i.PolyNode.prototype.Childs=function(){return this.m_Childs};i.PolyNode.prototype.Parent=function(){return this.m_Parent};i.PolyNode.prototype.IsHole=function(){return this.IsHoleNode()};i.PolyTree=function(){this.m_AllPolys=[];i.PolyNode.call(this)};i.PolyTree.prototype.Clear=function(){for(var e=0,t=this.m_AllPolys.length;e<t;e++)this.m_AllPolys[e]=null;this.m_AllPolys.length=0;this.m_Childs.length=0};i.PolyTree.prototype.GetFirst=function(){if(this.m_Childs.length>0)return this.m_Childs[0];else return null};i.PolyTree.prototype.Total=function(){return this.m_AllPolys.length};yn(i.PolyTree,i.PolyNode);i.Math_Abs_Int64=i.Math_Abs_Int32=i.Math_Abs_Double=function(e){return Math.abs(e)};i.Math_Max_Int32_Int32=function(e,t){return Math.max(e,t)};if(u.msie||u.opera||u.safari)i.Cast_Int32=function(e){return e|0};else i.Cast_Int32=function(e){return~~e};if(u.chrome)i.Cast_Int64=function(e){if(e<-2147483648||e>2147483647)return e<0?Math.ceil(e):Math.floor(e);else return~~e};else if(u.firefox&&typeof Number.toInteger=="function")i.Cast_Int64=function(e){return Number.toInteger(e)};else if(u.msie7||u.msie8)i.Cast_Int64=function(e){return parseInt(e,10)};else if(u.msie)i.Cast_Int64=function(e){if(e<-2147483648||e>2147483647)return e<0?Math.ceil(e):Math.floor(e);return e|0};else i.Cast_Int64=function(e){return e<0?Math.ceil(e):Math.floor(e)};i.Clear=function(e){e.length=0};i.PI=3.141592653589793;i.PI2=2*3.141592653589793;i.IntPoint=function(){var e=arguments,n=e.length;this.X=0;this.Y=0;if(t){this.Z=0;if(n==3){this.X=e[0];this.Y=e[1];this.Z=e[2]}else if(n==2){this.X=e[0];this.Y=e[1];this.Z=0}else if(n==1){if(e[0]instanceof i.DoublePoint){var r=e[0];this.X=i.Clipper.Round(r.X);this.Y=i.Clipper.Round(r.Y);this.Z=0}else{var s=e[0];if(typeof s.Z=="undefined")s.Z=0;this.X=s.X;this.Y=s.Y;this.Z=s.Z}}else{this.X=0;this.Y=0;this.Z=0}}else{if(n==2){this.X=e[0];this.Y=e[1]}else if(n==1){if(e[0]instanceof i.DoublePoint){var r=e[0];this.X=i.Clipper.Round(r.X);this.Y=i.Clipper.Round(r.Y)}else{var s=e[0];this.X=s.X;this.Y=s.Y}}else{this.X=0;this.Y=0}}};i.IntPoint.op_Equality=function(e,t){return e.X==t.X&&e.Y==t.Y};i.IntPoint.op_Inequality=function(e,t){return e.X!=t.X||e.Y!=t.Y};if(t){i.IntPoint0=function(){this.X=0;this.Y=0;this.Z=0};i.IntPoint1=function(e){this.X=e.X;this.Y=e.Y;this.Z=e.Z};i.IntPoint1dp=function(e){this.X=i.Clipper.Round(e.X);this.Y=i.Clipper.Round(e.Y);this.Z=0};i.IntPoint2=function(e,t){this.X=e;this.Y=t;this.Z=0};i.IntPoint3=function(e,t,n){this.X=e;this.Y=t;this.Z=n}}else{i.IntPoint0=function(){this.X=0;this.Y=0};i.IntPoint1=function(e){this.X=e.X;this.Y=e.Y};i.IntPoint1dp=function(e){this.X=i.Clipper.Round(e.X);this.Y=i.Clipper.Round(e.Y)};i.IntPoint2=function(e,t){this.X=e;this.Y=t}}i.IntRect=function(){var e=arguments,t=e.length;if(t==4){this.left=e[0];this.top=e[1];this.right=e[2];this.bottom=e[3]}else if(t==1){this.left=ir.left;this.top=ir.top;this.right=ir.right;this.bottom=ir.bottom}else{this.left=0;this.top=0;this.right=0;this.bottom=0}};i.IntRect0=function(){this.left=0;this.top=0;this.right=0;this.bottom=0};i.IntRect1=function(e){this.left=e.left;this.top=e.top;this.right=e.right;this.bottom=e.bottom};i.IntRect4=function(e,t,n,r){this.left=e;this.top=t;this.right=n;this.bottom=r};i.ClipType={ctIntersection:0,ctUnion:1,ctDifference:2,ctXor:3};i.PolyType={ptSubject:0,ptClip:1};i.PolyFillType={pftEvenOdd:0,pftNonZero:1,pftPositive:2,pftNegative:3};i.JoinType={jtSquare:0,jtRound:1,jtMiter:2};i.EndType={etOpenSquare:0,etOpenRound:1,etOpenButt:2,etClosedLine:3,etClosedPolygon:4};if(r)i.EndType_={etSquare:0,etRound:1,etButt:2,etClosed:3};i.EdgeSide={esLeft:0,esRight:1};i.Direction={dRightToLeft:0,dLeftToRight:1};i.TEdge=function(){this.Bot=new i.IntPoint;this.Curr=new i.IntPoint;this.Top=new i.IntPoint;this.Delta=new i.IntPoint;this.Dx=0;this.PolyTyp=i.PolyType.ptSubject;this.Side=i.EdgeSide.esLeft;this.WindDelta=0;this.WindCnt=0;this.WindCnt2=0;this.OutIdx=0;this.Next=null;this.Prev=null;this.NextInLML=null;this.NextInAEL=null;this.PrevInAEL=null;this.NextInSEL=null;this.PrevInSEL=null};i.IntersectNode=function(){this.Edge1=null;this.Edge2=null;this.Pt=new i.IntPoint};i.MyIntersectNodeSort=function(){};i.MyIntersectNodeSort.Compare=function(e,t){return t.Pt.Y-e.Pt.Y};i.LocalMinima=function(){this.Y=0;this.LeftBound=null;this.RightBound=null;this.Next=null};i.Scanbeam=function(){this.Y=0;this.Next=null};i.OutRec=function(){this.Idx=0;this.IsHole=false;this.IsOpen=false;this.FirstLeft=null;this.Pts=null;this.BottomPt=null;this.PolyNode=null};i.OutPt=function(){this.Idx=0;this.Pt=new i.IntPoint;this.Next=null;this.Prev=null};i.Join=function(){this.OutPt1=null;this.OutPt2=null;this.OffPt=new i.IntPoint};i.ClipperBase=function(){this.m_MinimaList=null;this.m_CurrentLM=null;this.m_edges=new Array;this.m_UseFullRange=false;this.m_HasOpenPaths=false;this.PreserveCollinear=false;this.m_MinimaList=null;this.m_CurrentLM=null;this.m_UseFullRange=false;this.m_HasOpenPaths=false};i.ClipperBase.horizontal=-9007199254740992;i.ClipperBase.Skip=-2;i.ClipperBase.Unassigned=-1;i.ClipperBase.tolerance=1e-20;if(e){i.ClipperBase.loRange=46340;i.ClipperBase.hiRange=46340}else{i.ClipperBase.loRange=47453132;i.ClipperBase.hiRange=0xfffffffffffff}i.ClipperBase.near_zero=function(e){return e>-i.ClipperBase.tolerance&&e<i.ClipperBase.tolerance};i.ClipperBase.IsHorizontal=function(e){return e.Delta.Y===0};i.ClipperBase.prototype.PointIsVertex=function(e,t){var n=t;do{if(i.IntPoint.op_Equality(n.Pt,e))return true;n=n.Next}while(n!=t);return false};i.ClipperBase.prototype.PointOnLineSegment=function(e,t,n,r){if(r)return e.X==t.X&&e.Y==t.Y||e.X==n.X&&e.Y==n.Y||e.X>t.X==e.X<n.X&&e.Y>t.Y==e.Y<n.Y&&gn.op_Equality(gn.Int128Mul(e.X-t.X,n.Y-t.Y),gn.Int128Mul(n.X-t.X,e.Y-t.Y));else return e.X==t.X&&e.Y==t.Y||e.X==n.X&&e.Y==n.Y||e.X>t.X==e.X<n.X&&e.Y>t.Y==e.Y<n.Y&&(e.X-t.X)*(n.Y-t.Y)==(n.X-t.X)*(e.Y-t.Y)};i.ClipperBase.prototype.PointOnPolygon=function(e,t,n){var r=t;while(true){if(this.PointOnLineSegment(e,r.Pt,r.Next.Pt,n))return true;r=r.Next;if(r==t)break}return false};i.ClipperBase.prototype.SlopesEqual=i.ClipperBase.SlopesEqual=function(){var e=arguments,t=e.length;var n,r,s,o,u,a,f;if(t==3){n=e[0];r=e[1];f=e[2];if(f)return gn.op_Equality(gn.Int128Mul(n.Delta.Y,r.Delta.X),gn.Int128Mul(n.Delta.X,r.Delta.Y));else return i.Cast_Int64(n.Delta.Y*r.Delta.X)==i.Cast_Int64(n.Delta.X*r.Delta.Y)}else if(t==4){s=e[0];o=e[1];u=e[2];f=e[3];if(f)return gn.op_Equality(gn.Int128Mul(s.Y-o.Y,o.X-u.X),gn.Int128Mul(s.X-o.X,o.Y-u.Y));else return i.Cast_Int64((s.Y-o.Y)*(o.X-u.X))-i.Cast_Int64((s.X-o.X)*(o.Y-u.Y))===0}else{s=e[0];o=e[1];u=e[2];a=e[3];f=e[4];if(f)return gn.op_Equality(gn.Int128Mul(s.Y-o.Y,u.X-a.X),gn.Int128Mul(s.X-o.X,u.Y-a.Y));else return i.Cast_Int64((s.Y-o.Y)*(u.X-a.X))-i.Cast_Int64((s.X-o.X)*(u.Y-a.Y))===0}};i.ClipperBase.SlopesEqual3=function(e,t,n){if(n)return gn.op_Equality(gn.Int128Mul(e.Delta.Y,t.Delta.X),gn.Int128Mul(e.Delta.X,t.Delta.Y));else return i.Cast_Int64(e.Delta.Y*t.Delta.X)==i.Cast_Int64(e.Delta.X*t.Delta.Y)};i.ClipperBase.SlopesEqual4=function(e,t,n,r){if(r)return gn.op_Equality(gn.Int128Mul(e.Y-t.Y,t.X-n.X),gn.Int128Mul(e.X-t.X,t.Y-n.Y));else return i.Cast_Int64((e.Y-t.Y)*(t.X-n.X))-i.Cast_Int64((e.X-t.X)*(t.Y-n.Y))===0};i.ClipperBase.SlopesEqual5=function(e,t,n,r,s){if(s)return gn.op_Equality(gn.Int128Mul(e.Y-t.Y,n.X-r.X),gn.Int128Mul(e.X-t.X,n.Y-r.Y));else return i.Cast_Int64((e.Y-t.Y)*(n.X-r.X))-i.Cast_Int64((e.X-t.X)*(n.Y-r.Y))===0};i.ClipperBase.prototype.Clear=function(){this.DisposeLocalMinimaList();for(var e=0,t=this.m_edges.length;e<t;++e){for(var n=0,r=this.m_edges[e].length;n<r;++n)this.m_edges[e][n]=null;i.Clear(this.m_edges[e])}i.Clear(this.m_edges);this.m_UseFullRange=false;this.m_HasOpenPaths=false};i.ClipperBase.prototype.DisposeLocalMinimaList=function(){while(this.m_MinimaList!==null){var e=this.m_MinimaList.Next;this.m_MinimaList=null;this.m_MinimaList=e}this.m_CurrentLM=null};i.ClipperBase.prototype.RangeTest=function(e,t){if(t.Value){if(e.X>i.ClipperBase.hiRange||e.Y>i.ClipperBase.hiRange||-e.X>i.ClipperBase.hiRange||-e.Y>i.ClipperBase.hiRange)i.Error("Coordinate outside allowed range in RangeTest().")}else if(e.X>i.ClipperBase.loRange||e.Y>i.ClipperBase.loRange||-e.X>i.ClipperBase.loRange||-e.Y>i.ClipperBase.loRange){t.Value=true;this.RangeTest(e,t)}};i.ClipperBase.prototype.InitEdge=function(e,t,n,r){e.Next=t;e.Prev=n;e.Curr.X=r.X;e.Curr.Y=r.Y;e.OutIdx=-1};i.ClipperBase.prototype.InitEdge2=function(e,t){if(e.Curr.Y>=e.Next.Curr.Y){e.Bot.X=e.Curr.X;e.Bot.Y=e.Curr.Y;e.Top.X=e.Next.Curr.X;e.Top.Y=e.Next.Curr.Y}else{e.Top.X=e.Curr.X;e.Top.Y=e.Curr.Y;e.Bot.X=e.Next.Curr.X;e.Bot.Y=e.Next.Curr.Y}this.SetDx(e);e.PolyTyp=t};i.ClipperBase.prototype.FindNextLocMin=function(e){var t;for(;;){while(i.IntPoint.op_Inequality(e.Bot,e.Prev.Bot)||i.IntPoint.op_Equality(e.Curr,e.Top))e=e.Next;if(e.Dx!=i.ClipperBase.horizontal&&e.Prev.Dx!=i.ClipperBase.horizontal)break;while(e.Prev.Dx==i.ClipperBase.horizontal)e=e.Prev;t=e;while(e.Dx==i.ClipperBase.horizontal)e=e.Next;if(e.Top.Y==e.Prev.Bot.Y)continue;if(t.Prev.Bot.X<e.Bot.X)e=t;break}return e};i.ClipperBase.prototype.ProcessBound=function(e,t){var n=e,r=e;var s;var o;if(e.Dx==i.ClipperBase.horizontal){if(t)o=e.Prev.Bot.X;else o=e.Next.Bot.X;if(e.Bot.X!=o)this.ReverseHorizontal(e)}if(r.OutIdx!=i.ClipperBase.Skip){if(t){while(r.Top.Y==r.Next.Bot.Y&&r.Next.OutIdx!=i.ClipperBase.Skip)r=r.Next;if(r.Dx==i.ClipperBase.horizontal&&r.Next.OutIdx!=i.ClipperBase.Skip){s=r;while(s.Prev.Dx==i.ClipperBase.horizontal)s=s.Prev;if(s.Prev.Top.X==r.Next.Top.X){if(!t)r=s.Prev}else if(s.Prev.Top.X>r.Next.Top.X)r=s.Prev}while(e!=r){e.NextInLML=e.Next;if(e.Dx==i.ClipperBase.horizontal&&e!=n&&e.Bot.X!=e.Prev.Top.X)this.ReverseHorizontal(e);e=e.Next}if(e.Dx==i.ClipperBase.horizontal&&e!=n&&e.Bot.X!=e.Prev.Top.X)this.ReverseHorizontal(e);r=r.Next}else{while(r.Top.Y==r.Prev.Bot.Y&&r.Prev.OutIdx!=i.ClipperBase.Skip)r=r.Prev;if(r.Dx==i.ClipperBase.horizontal&&r.Prev.OutIdx!=i.ClipperBase.Skip){s=r;while(s.Next.Dx==i.ClipperBase.horizontal)s=s.Next;if(s.Next.Top.X==r.Prev.Top.X){if(!t)r=s.Next}else if(s.Next.Top.X>r.Prev.Top.X)r=s.Next}while(e!=r){e.NextInLML=e.Prev;if(e.Dx==i.ClipperBase.horizontal&&e!=n&&e.Bot.X!=e.Next.Top.X)this.ReverseHorizontal(e);e=e.Prev}if(e.Dx==i.ClipperBase.horizontal&&e!=n&&e.Bot.X!=e.Next.Top.X)this.ReverseHorizontal(e);r=r.Prev}}if(r.OutIdx==i.ClipperBase.Skip){e=r;if(t){while(e.Top.Y==e.Next.Bot.Y)e=e.Next;while(e!=r&&e.Dx==i.ClipperBase.horizontal)e=e.Prev}else{while(e.Top.Y==e.Prev.Bot.Y)e=e.Prev;while(e!=r&&e.Dx==i.ClipperBase.horizontal)e=e.Next}if(e==r){if(t)r=e.Next;else r=e.Prev}else{if(t)e=r.Next;else e=r.Prev;var u=new i.LocalMinima;u.Next=null;u.Y=e.Bot.Y;u.LeftBound=null;u.RightBound=e;u.RightBound.WindDelta=0;r=this.ProcessBound(u.RightBound,t);this.InsertLocalMinima(u)}}return r};i.ClipperBase.prototype.AddPath=function(e,t,r){if(n){if(!r&&t==i.PolyType.ptClip)i.Error("AddPath: Open paths must be subject.")}else{if(!r)i.Error("AddPath: Open paths have been disabled.")}var s=e.length-1;if(r)while(s>0&&i.IntPoint.op_Equality(e[s],e[0]))--s;while(s>0&&i.IntPoint.op_Equality(e[s],e[s-1]))--s;if(r&&s<2||!r&&s<1)return false;var o=new Array;for(var u=0;u<=s;u++)o.push(new i.TEdge);var a=true;o[1].Curr.X=e[1].X;o[1].Curr.Y=e[1].Y;var f={Value:this.m_UseFullRange};this.RangeTest(e[0],f);this.m_UseFullRange=f.Value;f.Value=this.m_UseFullRange;this.RangeTest(e[s],f);this.m_UseFullRange=f.Value;this.InitEdge(o[0],o[1],o[s],e[0]);this.InitEdge(o[s],o[0],o[s-1],e[s]);for(var u=s-1;u>=1;--u){f.Value=this.m_UseFullRange;this.RangeTest(e[u],f);this.m_UseFullRange=f.Value;this.InitEdge(o[u],o[u+1],o[u-1],e[u])}var l=o[0];var c=l,h=l;for(;;){if(i.IntPoint.op_Equality(c.Curr,c.Next.Curr)){if(c==c.Next)break;if(c==l)l=c.Next;c=this.RemoveEdge(c);h=c;continue}if(c.Prev==c.Next)break;else if(r&&i.ClipperBase.SlopesEqual(c.Prev.Curr,c.Curr,c.Next.Curr,this.m_UseFullRange)&&(!this.PreserveCollinear||!this.Pt2IsBetweenPt1AndPt3(c.Prev.Curr,c.Curr,c.Next.Curr))){if(c==l)l=c.Next;c=this.RemoveEdge(c);c=c.Prev;h=c;continue}c=c.Next;if(c==h)break}if(!r&&c==c.Next||r&&c.Prev==c.Next)return false;if(!r){this.m_HasOpenPaths=true;l.Prev.OutIdx=i.ClipperBase.Skip}var p=l;c=l;do{this.InitEdge2(c,t);c=c.Next;if(a&&c.Curr.Y!=l.Curr.Y)a=false}while(c!=l);if(a){if(r)return false;c.Prev.OutIdx=i.ClipperBase.Skip;if(c.Prev.Bot.X<c.Prev.Top.X)this.ReverseHorizontal(c.Prev);var d=new i.LocalMinima;d.Next=null;d.Y=c.Bot.Y;d.LeftBound=null;d.RightBound=c;d.RightBound.Side=i.EdgeSide.esRight;d.RightBound.WindDelta=0;while(c.Next.OutIdx!=i.ClipperBase.Skip){c.NextInLML=c.Next;if(c.Bot.X!=c.Prev.Top.X)this.ReverseHorizontal(c);c=c.Next}this.InsertLocalMinima(d);this.m_edges.push(o);return true}this.m_edges.push(o);var v;var m=null;for(;;){c=this.FindNextLocMin(c);if(c==m)break;else if(m==null)m=c;var d=new i.LocalMinima;d.Next=null;d.Y=c.Bot.Y;if(c.Dx<c.Prev.Dx){d.LeftBound=c.Prev;d.RightBound=c;v=false}else{d.LeftBound=c;d.RightBound=c.Prev;v=true}d.LeftBound.Side=i.EdgeSide.esLeft;d.RightBound.Side=i.EdgeSide.esRight;if(!r)d.LeftBound.WindDelta=0;else if(d.LeftBound.Next==d.RightBound)d.LeftBound.WindDelta=-1;else d.LeftBound.WindDelta=1;d.RightBound.WindDelta=-d.LeftBound.WindDelta;c=this.ProcessBound(d.LeftBound,v);var g=this.ProcessBound(d.RightBound,!v);if(d.LeftBound.OutIdx==i.ClipperBase.Skip)d.LeftBound=null;else if(d.RightBound.OutIdx==i.ClipperBase.Skip)d.RightBound=null;this.InsertLocalMinima(d);if(!v)c=g}return true};i.ClipperBase.prototype.AddPaths=function(e,t,n){var r=false;for(var i=0,s=e.length;i<s;++i)if(this.AddPath(e[i],t,n))r=true;return r};i.ClipperBase.prototype.Pt2IsBetweenPt1AndPt3=function(e,t,n){if(i.IntPoint.op_Equality(e,n)||i.IntPoint.op_Equality(e,t)||i.IntPoint.op_Equality(n,t))return false;else if(e.X!=n.X)return t.X>e.X==t.X<n.X;else return t.Y>e.Y==t.Y<n.Y};i.ClipperBase.prototype.RemoveEdge=function(e){e.Prev.Next=e.Next;e.Next.Prev=e.Prev;var t=e.Next;e.Prev=null;return t};i.ClipperBase.prototype.SetDx=function(e){e.Delta.X=e.Top.X-e.Bot.X;e.Delta.Y=e.Top.Y-e.Bot.Y;if(e.Delta.Y===0)e.Dx=i.ClipperBase.horizontal;else e.Dx=e.Delta.X/e.Delta.Y};i.ClipperBase.prototype.InsertLocalMinima=function(e){if(this.m_MinimaList===null){this.m_MinimaList=e}else if(e.Y>=this.m_MinimaList.Y){e.Next=this.m_MinimaList;this.m_MinimaList=e}else{var t=this.m_MinimaList;while(t.Next!==null&&e.Y<t.Next.Y)t=t.Next;e.Next=t.Next;t.Next=e}};i.ClipperBase.prototype.PopLocalMinima=function(){if(this.m_CurrentLM===null)return;this.m_CurrentLM=this.m_CurrentLM.Next};i.ClipperBase.prototype.ReverseHorizontal=function(e){var n=e.Top.X;e.Top.X=e.Bot.X;e.Bot.X=n;if(t){n=e.Top.Z;e.Top.Z=e.Bot.Z;e.Bot.Z=n}};i.ClipperBase.prototype.Reset=function(){this.m_CurrentLM=this.m_MinimaList;if(this.m_CurrentLM==null)return;var e=this.m_MinimaList;while(e!=null){var t=e.LeftBound;if(t!=null){t.Curr.X=t.Bot.X;t.Curr.Y=t.Bot.Y;t.Side=i.EdgeSide.esLeft;t.OutIdx=i.ClipperBase.Unassigned}t=e.RightBound;if(t!=null){t.Curr.X=t.Bot.X;t.Curr.Y=t.Bot.Y;t.Side=i.EdgeSide.esRight;t.OutIdx=i.ClipperBase.Unassigned}e=e.Next}};i.Clipper=function(e){if(typeof e=="undefined")e=0;this.m_PolyOuts=null;this.m_ClipType=i.ClipType.ctIntersection;this.m_Scanbeam=null;this.m_ActiveEdges=null;this.m_SortedEdges=null;this.m_IntersectList=null;this.m_IntersectNodeComparer=null;this.m_ExecuteLocked=false;this.m_ClipFillType=i.PolyFillType.pftEvenOdd;this.m_SubjFillType=i.PolyFillType.pftEvenOdd;this.m_Joins=null;this.m_GhostJoins=null;this.m_UsingPolyTree=false;this.ReverseSolution=false;this.StrictlySimple=false;i.ClipperBase.call(this);this.m_Scanbeam=null;this.m_ActiveEdges=null;this.m_SortedEdges=null;this.m_IntersectList=new Array;this.m_IntersectNodeComparer=i.MyIntersectNodeSort.Compare;this.m_ExecuteLocked=false;this.m_UsingPolyTree=false;this.m_PolyOuts=new Array;this.m_Joins=new Array;this.m_GhostJoins=new Array;this.ReverseSolution=(1&e)!==0;this.StrictlySimple=(2&e)!==0;this.PreserveCollinear=(4&e)!==0;if(t){this.ZFillFunction=null}};i.Clipper.ioReverseSolution=1;i.Clipper.ioStrictlySimple=2;i.Clipper.ioPreserveCollinear=4;i.Clipper.prototype.Clear=function(){if(this.m_edges.length===0)return;this.DisposeAllPolyPts();i.ClipperBase.prototype.Clear.call(this)};i.Clipper.prototype.DisposeScanbeamList=function(){while(this.m_Scanbeam!==null){var e=this.m_Scanbeam.Next;this.m_Scanbeam=null;this.m_Scanbeam=e}};i.Clipper.prototype.Reset=function(){i.ClipperBase.prototype.Reset.call(this);this.m_Scanbeam=null;this.m_ActiveEdges=null;this.m_SortedEdges=null;var e=this.m_MinimaList;while(e!==null){this.InsertScanbeam(e.Y);e=e.Next}};i.Clipper.prototype.InsertScanbeam=function(e){if(this.m_Scanbeam===null){this.m_Scanbeam=new i.Scanbeam;this.m_Scanbeam.Next=null;this.m_Scanbeam.Y=e}else if(e>this.m_Scanbeam.Y){var t=new i.Scanbeam;t.Y=e;t.Next=this.m_Scanbeam;this.m_Scanbeam=t}else{var n=this.m_Scanbeam;while(n.Next!==null&&e<=n.Next.Y)n=n.Next;if(e==n.Y)return;var t=new i.Scanbeam;t.Y=e;t.Next=n.Next;n.Next=t}};i.Clipper.prototype.Execute=function(){var e=arguments,t=e.length,n=e[1]instanceof i.PolyTree;if(t==4&&!n){var r=e[0],s=e[1],o=e[2],u=e[3];if(this.m_ExecuteLocked)return false;if(this.m_HasOpenPaths)i.Error("Error: PolyTree struct is need for open path clipping.");this.m_ExecuteLocked=true;i.Clear(s);this.m_SubjFillType=o;this.m_ClipFillType=u;this.m_ClipType=r;this.m_UsingPolyTree=false;try{var a=this.ExecuteInternal();if(a)this.BuildResult(s)}finally{this.DisposeAllPolyPts();this.m_ExecuteLocked=false}return a}else if(t==4&&n){var r=e[0],f=e[1],o=e[2],u=e[3];if(this.m_ExecuteLocked)return false;this.m_ExecuteLocked=true;this.m_SubjFillType=o;this.m_ClipFillType=u;this.m_ClipType=r;this.m_UsingPolyTree=true;try{var a=this.ExecuteInternal();if(a)this.BuildResult2(f)}finally{this.DisposeAllPolyPts();this.m_ExecuteLocked=false}return a}else if(t==2&&!n){var r=e[0],s=e[1];return this.Execute(r,s,i.PolyFillType.pftEvenOdd,i.PolyFillType.pftEvenOdd)}else if(t==2&&n){var r=e[0],f=e[1];return this.Execute(r,f,i.PolyFillType.pftEvenOdd,i.PolyFillType.pftEvenOdd)}};i.Clipper.prototype.FixHoleLinkage=function(e){if(e.FirstLeft===null||e.IsHole!=e.FirstLeft.IsHole&&e.FirstLeft.Pts!==null)return;var t=e.FirstLeft;while(t!==null&&(t.IsHole==e.IsHole||t.Pts===null))t=t.FirstLeft;e.FirstLeft=t};i.Clipper.prototype.ExecuteInternal=function(){try{this.Reset();if(this.m_CurrentLM===null)return false;var e=this.PopScanbeam();do{this.InsertLocalMinimaIntoAEL(e);i.Clear(this.m_GhostJoins);this.ProcessHorizontals(false);if(this.m_Scanbeam===null)break;var t=this.PopScanbeam();if(!this.ProcessIntersections(e,t))return false;this.ProcessEdgesAtTopOfScanbeam(t);e=t}while(this.m_Scanbeam!==null||this.m_CurrentLM!==null);for(var n=0,r=this.m_PolyOuts.length;n<r;n++){var s=this.m_PolyOuts[n];if(s.Pts===null||s.IsOpen)continue;if((s.IsHole^this.ReverseSolution)==this.Area(s)>0)this.ReversePolyPtLinks(s.Pts)}this.JoinCommonEdges();for(var n=0,r=this.m_PolyOuts.length;n<r;n++){var s=this.m_PolyOuts[n];if(s.Pts!==null&&!s.IsOpen)this.FixupOutPolygon(s)}if(this.StrictlySimple)this.DoSimplePolygons();return true}finally{i.Clear(this.m_Joins);i.Clear(this.m_GhostJoins)}};i.Clipper.prototype.PopScanbeam=function(){var e=this.m_Scanbeam.Y;var t=this.m_Scanbeam;this.m_Scanbeam=this.m_Scanbeam.Next;t=null;return e};i.Clipper.prototype.DisposeAllPolyPts=function(){for(var e=0,t=this.m_PolyOuts.length;e<t;++e)this.DisposeOutRec(e);i.Clear(this.m_PolyOuts)};i.Clipper.prototype.DisposeOutRec=function(e){var t=this.m_PolyOuts[e];if(t.Pts!==null)this.DisposeOutPts(t.Pts);t=null;this.m_PolyOuts[e]=null};i.Clipper.prototype.DisposeOutPts=function(e){if(e===null)return;var t=null;e.Prev.Next=null;while(e!==null){t=e;e=e.Next;t=null}};i.Clipper.prototype.AddJoin=function(e,t,n){var r=new i.Join;r.OutPt1=e;r.OutPt2=t;r.OffPt.X=n.X;r.OffPt.Y=n.Y;this.m_Joins.push(r)};i.Clipper.prototype.AddGhostJoin=function(e,t){var n=new i.Join;n.OutPt1=e;n.OffPt.X=t.X;n.OffPt.Y=t.Y;this.m_GhostJoins.push(n)};if(t){i.Clipper.prototype.SetZ=function(e,t){e.Z=0;if(this.ZFillFunction!==null){if(t.OutIdx<0)this.ZFillFunction(t.Bot,t.Top,e);else this.ZFillFunction(t.Top,t.Bot,e)}}}i.Clipper.prototype.InsertLocalMinimaIntoAEL=function(e){while(this.m_CurrentLM!==null&&this.m_CurrentLM.Y==e){var t=this.m_CurrentLM.LeftBound;var n=this.m_CurrentLM.RightBound;this.PopLocalMinima();var r=null;if(t===null){this.InsertEdgeIntoAEL(n,null);this.SetWindingCount(n);if(this.IsContributing(n))r=this.AddOutPt(n,n.Bot)}else if(n==null){this.InsertEdgeIntoAEL(t,null);this.SetWindingCount(t);if(this.IsContributing(t))r=this.AddOutPt(t,t.Bot);this.InsertScanbeam(t.Top.Y)}else{this.InsertEdgeIntoAEL(t,null);this.InsertEdgeIntoAEL(n,t);this.SetWindingCount(t);n.WindCnt=t.WindCnt;n.WindCnt2=t.WindCnt2;if(this.IsContributing(t))r=this.AddLocalMinPoly(t,n,t.Bot);this.InsertScanbeam(t.Top.Y)}if(n!=null){if(i.ClipperBase.IsHorizontal(n))this.AddEdgeToSEL(n);else this.InsertScanbeam(n.Top.Y)}if(t==null||n==null)continue;if(r!==null&&i.ClipperBase.IsHorizontal(n)&&this.m_GhostJoins.length>0&&n.WindDelta!==0){for(var s=0,o=this.m_GhostJoins.length;s<o;s++){var u=this.m_GhostJoins[s];if(this.HorzSegmentsOverlap(u.OutPt1.Pt,u.OffPt,n.Bot,n.Top))this.AddJoin(u.OutPt1,r,u.OffPt)}}if(t.OutIdx>=0&&t.PrevInAEL!==null&&t.PrevInAEL.Curr.X==t.Bot.X&&t.PrevInAEL.OutIdx>=0&&i.ClipperBase.SlopesEqual(t.PrevInAEL,t,this.m_UseFullRange)&&t.WindDelta!==0&&t.PrevInAEL.WindDelta!==0){var a=this.AddOutPt(t.PrevInAEL,t.Bot);this.AddJoin(r,a,t.Top)}if(t.NextInAEL!=n){if(n.OutIdx>=0&&n.PrevInAEL.OutIdx>=0&&i.ClipperBase.SlopesEqual(n.PrevInAEL,n,this.m_UseFullRange)&&n.WindDelta!==0&&n.PrevInAEL.WindDelta!==0){var a=this.AddOutPt(n.PrevInAEL,n.Bot);this.AddJoin(r,a,n.Top)}var f=t.NextInAEL;if(f!==null)while(f!=n){this.IntersectEdges(n,f,t.Curr,false);f=f.NextInAEL}}}};i.Clipper.prototype.InsertEdgeIntoAEL=function(e,t){if(this.m_ActiveEdges===null){e.PrevInAEL=null;e.NextInAEL=null;this.m_ActiveEdges=e}else if(t===null&&this.E2InsertsBeforeE1(this.m_ActiveEdges,e)){e.PrevInAEL=null;e.NextInAEL=this.m_ActiveEdges;this.m_ActiveEdges.PrevInAEL=e;this.m_ActiveEdges=e}else{if(t===null)t=this.m_ActiveEdges;while(t.NextInAEL!==null&&!this.E2InsertsBeforeE1(t.NextInAEL,e))t=t.NextInAEL;e.NextInAEL=t.NextInAEL;if(t.NextInAEL!==null)t.NextInAEL.PrevInAEL=e;e.PrevInAEL=t;t.NextInAEL=e}};i.Clipper.prototype.E2InsertsBeforeE1=function(e,t){if(t.Curr.X==e.Curr.X){if(t.Top.Y>e.Top.Y)return t.Top.X<i.Clipper.TopX(e,t.Top.Y);else return e.Top.X>i.Clipper.TopX(t,e.Top.Y)}else return t.Curr.X<e.Curr.X};i.Clipper.prototype.IsEvenOddFillType=function(e){if(e.PolyTyp==i.PolyType.ptSubject)return this.m_SubjFillType==i.PolyFillType.pftEvenOdd;else return this.m_ClipFillType==i.PolyFillType.pftEvenOdd};i.Clipper.prototype.IsEvenOddAltFillType=function(e){if(e.PolyTyp==i.PolyType.ptSubject)return this.m_ClipFillType==i.PolyFillType.pftEvenOdd;else return this.m_SubjFillType==i.PolyFillType.pftEvenOdd};i.Clipper.prototype.IsContributing=function(e){var t,n;if(e.PolyTyp==i.PolyType.ptSubject){t=this.m_SubjFillType;n=this.m_ClipFillType}else{t=this.m_ClipFillType;n=this.m_SubjFillType}switch(t){case i.PolyFillType.pftEvenOdd:if(e.WindDelta===0&&e.WindCnt!=1)return false;break;case i.PolyFillType.pftNonZero:if(Math.abs(e.WindCnt)!=1)return false;break;case i.PolyFillType.pftPositive:if(e.WindCnt!=1)return false;break;default:if(e.WindCnt!=-1)return false;break}switch(this.m_ClipType){case i.ClipType.ctIntersection:switch(n){case i.PolyFillType.pftEvenOdd:case i.PolyFillType.pftNonZero:return e.WindCnt2!==0;case i.PolyFillType.pftPositive:return e.WindCnt2>0;default:return e.WindCnt2<0};case i.ClipType.ctUnion:switch(n){case i.PolyFillType.pftEvenOdd:case i.PolyFillType.pftNonZero:return e.WindCnt2===0;case i.PolyFillType.pftPositive:return e.WindCnt2<=0;default:return e.WindCnt2>=0};case i.ClipType.ctDifference:if(e.PolyTyp==i.PolyType.ptSubject)switch(n){case i.PolyFillType.pftEvenOdd:case i.PolyFillType.pftNonZero:return e.WindCnt2===0;case i.PolyFillType.pftPositive:return e.WindCnt2<=0;default:return e.WindCnt2>=0}else switch(n){case i.PolyFillType.pftEvenOdd:case i.PolyFillType.pftNonZero:return e.WindCnt2!==0;case i.PolyFillType.pftPositive:return e.WindCnt2>0;default:return e.WindCnt2<0};case i.ClipType.ctXor:if(e.WindDelta===0)switch(n){case i.PolyFillType.pftEvenOdd:case i.PolyFillType.pftNonZero:return e.WindCnt2===0;case i.PolyFillType.pftPositive:return e.WindCnt2<=0;default:return e.WindCnt2>=0}else return true}return true};i.Clipper.prototype.SetWindingCount=function(e){var t=e.PrevInAEL;while(t!==null&&(t.PolyTyp!=e.PolyTyp||t.WindDelta===0))t=t.PrevInAEL;if(t===null){e.WindCnt=e.WindDelta===0?1:e.WindDelta;e.WindCnt2=0;t=this.m_ActiveEdges}else if(e.WindDelta===0&&this.m_ClipType!=i.ClipType.ctUnion){e.WindCnt=1;e.WindCnt2=t.WindCnt2;t=t.NextInAEL}else if(this.IsEvenOddFillType(e)){if(e.WindDelta===0){var n=true;var r=t.PrevInAEL;while(r!==null){if(r.PolyTyp==t.PolyTyp&&r.WindDelta!==0)n=!n;r=r.PrevInAEL}e.WindCnt=n?0:1}else{e.WindCnt=e.WindDelta}e.WindCnt2=t.WindCnt2;t=t.NextInAEL}else{if(t.WindCnt*t.WindDelta<0){if(Math.abs(t.WindCnt)>1){if(t.WindDelta*e.WindDelta<0)e.WindCnt=t.WindCnt;else e.WindCnt=t.WindCnt+e.WindDelta}else e.WindCnt=e.WindDelta===0?1:e.WindDelta}else{if(e.WindDelta===0)e.WindCnt=t.WindCnt<0?t.WindCnt-1:t.WindCnt+1;else if(t.WindDelta*e.WindDelta<0)e.WindCnt=t.WindCnt;else e.WindCnt=t.WindCnt+e.WindDelta}e.WindCnt2=t.WindCnt2;t=t.NextInAEL}if(this.IsEvenOddAltFillType(e)){while(t!=e){if(t.WindDelta!==0)e.WindCnt2=e.WindCnt2===0?1:0;t=t.NextInAEL}}else{while(t!=e){e.WindCnt2+=t.WindDelta;t=t.NextInAEL}}};i.Clipper.prototype.AddEdgeToSEL=function(e){if(this.m_SortedEdges===null){this.m_SortedEdges=e;e.PrevInSEL=null;e.NextInSEL=null}else{e.NextInSEL=this.m_SortedEdges;e.PrevInSEL=null;this.m_SortedEdges.PrevInSEL=e;this.m_SortedEdges=e}};i.Clipper.prototype.CopyAELToSEL=function(){var e=this.m_ActiveEdges;this.m_SortedEdges=e;while(e!==null){e.PrevInSEL=e.PrevInAEL;e.NextInSEL=e.NextInAEL;e=e.NextInAEL}};i.Clipper.prototype.SwapPositionsInAEL=function(e,t){if(e.NextInAEL==e.PrevInAEL||t.NextInAEL==t.PrevInAEL)return;if(e.NextInAEL==t){var n=t.NextInAEL;if(n!==null)n.PrevInAEL=e;var r=e.PrevInAEL;if(r!==null)r.NextInAEL=t;t.PrevInAEL=r;t.NextInAEL=e;e.PrevInAEL=t;e.NextInAEL=n}else if(t.NextInAEL==e){var n=e.NextInAEL;if(n!==null)n.PrevInAEL=t;var r=t.PrevInAEL;if(r!==null)r.NextInAEL=e;e.PrevInAEL=r;e.NextInAEL=t;t.PrevInAEL=e;t.NextInAEL=n}else{var n=e.NextInAEL;var r=e.PrevInAEL;e.NextInAEL=t.NextInAEL;if(e.NextInAEL!==null)e.NextInAEL.PrevInAEL=e;e.PrevInAEL=t.PrevInAEL;if(e.PrevInAEL!==null)e.PrevInAEL.NextInAEL=e;t.NextInAEL=n;if(t.NextInAEL!==null)t.NextInAEL.PrevInAEL=t;t.PrevInAEL=r;if(t.PrevInAEL!==null)t.PrevInAEL.NextInAEL=t}if(e.PrevInAEL===null)this.m_ActiveEdges=e;else if(t.PrevInAEL===null)this.m_ActiveEdges=t};i.Clipper.prototype.SwapPositionsInSEL=function(e,t){if(e.NextInSEL===null&&e.PrevInSEL===null)return;if(t.NextInSEL===null&&t.PrevInSEL===null)return;if(e.NextInSEL==t){var n=t.NextInSEL;if(n!==null)n.PrevInSEL=e;var r=e.PrevInSEL;if(r!==null)r.NextInSEL=t;t.PrevInSEL=r;t.NextInSEL=e;e.PrevInSEL=t;e.NextInSEL=n}else if(t.NextInSEL==e){var n=e.NextInSEL;if(n!==null)n.PrevInSEL=t;var r=t.PrevInSEL;if(r!==null)r.NextInSEL=e;e.PrevInSEL=r;e.NextInSEL=t;t.PrevInSEL=e;t.NextInSEL=n}else{var n=e.NextInSEL;var r=e.PrevInSEL;e.NextInSEL=t.NextInSEL;if(e.NextInSEL!==null)e.NextInSEL.PrevInSEL=e;e.PrevInSEL=t.PrevInSEL;if(e.PrevInSEL!==null)e.PrevInSEL.NextInSEL=e;t.NextInSEL=n;if(t.NextInSEL!==null)t.NextInSEL.PrevInSEL=t;t.PrevInSEL=r;if(t.PrevInSEL!==null)t.PrevInSEL.NextInSEL=t}if(e.PrevInSEL===null)this.m_SortedEdges=e;else if(t.PrevInSEL===null)this.m_SortedEdges=t};i.Clipper.prototype.AddLocalMaxPoly=function(e,t,n){this.AddOutPt(e,n);if(t.WindDelta==0)this.AddOutPt(t,n);if(e.OutIdx==t.OutIdx){e.OutIdx=-1;t.OutIdx=-1}else if(e.OutIdx<t.OutIdx)this.AppendPolygon(e,t);else this.AppendPolygon(t,e)};i.Clipper.prototype.AddLocalMinPoly=function(e,t,n){var r;var s,o;if(i.ClipperBase.IsHorizontal(t)||e.Dx>t.Dx){r=this.AddOutPt(e,n);t.OutIdx=e.OutIdx;e.Side=i.EdgeSide.esLeft;t.Side=i.EdgeSide.esRight;s=e;if(s.PrevInAEL==t)o=t.PrevInAEL;else o=s.PrevInAEL}else{r=this.AddOutPt(t,n);e.OutIdx=t.OutIdx;e.Side=i.EdgeSide.esRight;t.Side=i.EdgeSide.esLeft;s=t;if(s.PrevInAEL==e)o=e.PrevInAEL;else o=s.PrevInAEL}if(o!==null&&o.OutIdx>=0&&i.Clipper.TopX(o,n.Y)==i.Clipper.TopX(s,n.Y)&&i.ClipperBase.SlopesEqual(s,o,this.m_UseFullRange)&&s.WindDelta!==0&&o.WindDelta!==0){var u=this.AddOutPt(o,n);this.AddJoin(r,u,s.Top)}return r};i.Clipper.prototype.CreateOutRec=function(){var e=new i.OutRec;e.Idx=-1;e.IsHole=false;e.IsOpen=false;e.FirstLeft=null;e.Pts=null;e.BottomPt=null;e.PolyNode=null;this.m_PolyOuts.push(e);e.Idx=this.m_PolyOuts.length-1;return e};i.Clipper.prototype.AddOutPt=function(e,n){var r=e.Side==i.EdgeSide.esLeft;if(e.OutIdx<0){var s=this.CreateOutRec();s.IsOpen=e.WindDelta===0;var o=new i.OutPt;s.Pts=o;o.Idx=s.Idx;o.Pt.X=n.X;o.Pt.Y=n.Y;o.Next=o;o.Prev=o;if(!s.IsOpen)this.SetHoleState(e,s);if(t){if(i.IntPoint.op_Equality(n,e.Bot)){o.Pt.X=e.Bot.X;o.Pt.Y=e.Bot.Y;o.Pt.Z=e.Bot.Z}else if(i.IntPoint.op_Equality(n,e.Top)){o.Pt.X=e.Top.X;o.Pt.Y=e.Top.Y;o.Pt.Z=e.Top.Z}else this.SetZ(o.Pt,e)}e.OutIdx=s.Idx;return o}else{var s=this.m_PolyOuts[e.OutIdx];var u=s.Pts;if(r&&i.IntPoint.op_Equality(n,u.Pt))return u;else if(!r&&i.IntPoint.op_Equality(n,u.Prev.Pt))return u.Prev;var o=new i.OutPt;o.Idx=s.Idx;o.Pt.X=n.X;o.Pt.Y=n.Y;o.Next=u;o.Prev=u.Prev;o.Prev.Next=o;u.Prev=o;if(r)s.Pts=o;if(t){if(i.IntPoint.op_Equality(n,e.Bot)){o.Pt.X=e.Bot.X;o.Pt.Y=e.Bot.Y;o.Pt.Z=e.Bot.Z}else if(i.IntPoint.op_Equality(n,e.Top)){o.Pt.X=e.Top.X;o.Pt.Y=e.Top.Y;o.Pt.Z=e.Top.Z}else this.SetZ(o.Pt,e)}return o}};i.Clipper.prototype.SwapPoints=function(e,t){var n=new i.IntPoint(e.Value);e.Value.X=t.Value.X;e.Value.Y=t.Value.Y;t.Value.X=n.X;t.Value.Y=n.Y};i.Clipper.prototype.HorzSegmentsOverlap=function(e,t,n,r){if(e.X>n.X==e.X<r.X)return true;else if(t.X>n.X==t.X<r.X)return true;else if(n.X>e.X==n.X<t.X)return true;else if(r.X>e.X==r.X<t.X)return true;else if(e.X==n.X&&t.X==r.X)return true;else if(e.X==r.X&&t.X==n.X)return true;else return false};i.Clipper.prototype.InsertPolyPtBetween=function(e,t,n){var r=new i.OutPt;r.Pt.X=n.X;r.Pt.Y=n.Y;if(t==e.Next){e.Next=r;t.Prev=r;r.Next=t;r.Prev=e}else{t.Next=r;e.Prev=r;r.Next=e;r.Prev=t}return r};i.Clipper.prototype.SetHoleState=function(e,t){var n=false;var r=e.PrevInAEL;while(r!==null){if(r.OutIdx>=0&&r.WindDelta!=0){n=!n;if(t.FirstLeft===null)t.FirstLeft=this.m_PolyOuts[r.OutIdx]}r=r.PrevInAEL}if(n)t.IsHole=true};i.Clipper.prototype.GetDx=function(e,t){if(e.Y==t.Y)return i.ClipperBase.horizontal;else return(t.X-e.X)/(t.Y-e.Y)};i.Clipper.prototype.FirstIsBottomPt=function(e,t){var n=e.Prev;while(i.IntPoint.op_Equality(n.Pt,e.Pt)&&n!=e)n=n.Prev;var r=Math.abs(this.GetDx(e.Pt,n.Pt));n=e.Next;while(i.IntPoint.op_Equality(n.Pt,e.Pt)&&n!=e)n=n.Next;var s=Math.abs(this.GetDx(e.Pt,n.Pt));n=t.Prev;while(i.IntPoint.op_Equality(n.Pt,t.Pt)&&n!=t)n=n.Prev;var o=Math.abs(this.GetDx(t.Pt,n.Pt));n=t.Next;while(i.IntPoint.op_Equality(n.Pt,t.Pt)&&n!=t)n=n.Next;var u=Math.abs(this.GetDx(t.Pt,n.Pt));return r>=o&&r>=u||s>=o&&s>=u};i.Clipper.prototype.GetBottomPt=function(e){var t=null;var n=e.Next;while(n!=e){if(n.Pt.Y>e.Pt.Y){e=n;t=null}else if(n.Pt.Y==e.Pt.Y&&n.Pt.X<=e.Pt.X){if(n.Pt.X<e.Pt.X){t=null;e=n}else{if(n.Next!=e&&n.Prev!=e)t=n}}n=n.Next}if(t!==null){while(t!=n){if(!this.FirstIsBottomPt(n,t))e=t;t=t.Next;while(i.IntPoint.op_Inequality(t.Pt,e.Pt))t=t.Next}}return e};i.Clipper.prototype.GetLowermostRec=function(e,t){if(e.BottomPt===null)e.BottomPt=this.GetBottomPt(e.Pts);if(t.BottomPt===null)t.BottomPt=this.GetBottomPt(t.Pts);var n=e.BottomPt;var r=t.BottomPt;if(n.Pt.Y>r.Pt.Y)return e;else if(n.Pt.Y<r.Pt.Y)return t;else if(n.Pt.X<r.Pt.X)return e;else if(n.Pt.X>r.Pt.X)return t;else if(n.Next==n)return t;else if(r.Next==r)return e;else if(this.FirstIsBottomPt(n,r))return e;else return t};i.Clipper.prototype.Param1RightOfParam2=function(e,t){do{e=e.FirstLeft;if(e==t)return true}while(e!==null);return false};i.Clipper.prototype.GetOutRec=function(e){var t=this.m_PolyOuts[e];while(t!=this.m_PolyOuts[t.Idx])t=this.m_PolyOuts[t.Idx];return t};i.Clipper.prototype.AppendPolygon=function(e,t){var n=this.m_PolyOuts[e.OutIdx];var r=this.m_PolyOuts[t.OutIdx];var s;if(this.Param1RightOfParam2(n,r))s=r;else if(this.Param1RightOfParam2(r,n))s=n;else s=this.GetLowermostRec(n,r);var o=n.Pts;var u=o.Prev;var a=r.Pts;var f=a.Prev;var l;if(e.Side==i.EdgeSide.esLeft){if(t.Side==i.EdgeSide.esLeft){this.ReversePolyPtLinks(a);a.Next=o;o.Prev=a;u.Next=f;f.Prev=u;n.Pts=f}else{f.Next=o;o.Prev=f;a.Prev=u;u.Next=a;n.Pts=a}l=i.EdgeSide.esLeft}else{if(t.Side==i.EdgeSide.esRight){this.ReversePolyPtLinks(a);u.Next=f;f.Prev=u;a.Next=o;o.Prev=a}else{u.Next=a;a.Prev=u;o.Prev=f;f.Next=o}l=i.EdgeSide.esRight}n.BottomPt=null;if(s==r){if(r.FirstLeft!=n)n.FirstLeft=r.FirstLeft;n.IsHole=r.IsHole}r.Pts=null;r.BottomPt=null;r.FirstLeft=n;var c=e.OutIdx;var h=t.OutIdx;e.OutIdx=-1;t.OutIdx=-1;var p=this.m_ActiveEdges;while(p!==null){if(p.OutIdx==h){p.OutIdx=c;p.Side=l;break}p=p.NextInAEL}r.Idx=n.Idx};i.Clipper.prototype.ReversePolyPtLinks=function(e){if(e===null)return;var t;var n;t=e;do{n=t.Next;t.Next=t.Prev;t.Prev=n;t=n}while(t!=e)};i.Clipper.SwapSides=function(e,t){var n=e.Side;e.Side=t.Side;t.Side=n};i.Clipper.SwapPolyIndexes=function(e,t){var n=e.OutIdx;e.OutIdx=t.OutIdx;t.OutIdx=n};i.Clipper.prototype.IntersectEdges=function(e,t,r,s){var o=!s&&e.NextInLML===null&&e.Top.X==r.X&&e.Top.Y==r.Y;var u=!s&&t.NextInLML===null&&t.Top.X==r.X&&t.Top.Y==r.Y;var a=e.OutIdx>=0;var f=t.OutIdx>=0;if(n){if(e.WindDelta===0||t.WindDelta===0){if(e.WindDelta===0&&t.WindDelta===0){if((o||u)&&a&&f)this.AddLocalMaxPoly(e,t,r)}else if(e.PolyTyp==t.PolyTyp&&e.WindDelta!=t.WindDelta&&this.m_ClipType==i.ClipType.ctUnion){if(e.WindDelta===0){if(f){this.AddOutPt(e,r);if(a)e.OutIdx=-1}}else{if(a){this.AddOutPt(t,r);if(f)t.OutIdx=-1}}}else if(e.PolyTyp!=t.PolyTyp){if(e.WindDelta===0&&Math.abs(t.WindCnt)==1&&(this.m_ClipType!=i.ClipType.ctUnion||t.WindCnt2===0)){this.AddOutPt(e,r);if(a)e.OutIdx=-1}else if(t.WindDelta===0&&Math.abs(e.WindCnt)==1&&(this.m_ClipType!=i.ClipType.ctUnion||e.WindCnt2===0)){this.AddOutPt(t,r);if(f)t.OutIdx=-1}}if(o)if(e.OutIdx<0)this.DeleteFromAEL(e);else i.Error("Error intersecting polylines");if(u)if(t.OutIdx<0)this.DeleteFromAEL(t);else i.Error("Error intersecting polylines");return}}if(e.PolyTyp==t.PolyTyp){if(this.IsEvenOddFillType(e)){var l=e.WindCnt;e.WindCnt=t.WindCnt;t.WindCnt=l}else{if(e.WindCnt+t.WindDelta===0)e.WindCnt=-e.WindCnt;else e.WindCnt+=t.WindDelta;if(t.WindCnt-e.WindDelta===0)t.WindCnt=-t.WindCnt;else t.WindCnt-=e.WindDelta}}else{if(!this.IsEvenOddFillType(t))e.WindCnt2+=t.WindDelta;else e.WindCnt2=e.WindCnt2===0?1:0;if(!this.IsEvenOddFillType(e))t.WindCnt2-=e.WindDelta;else t.WindCnt2=t.WindCnt2===0?1:0}var c,h,p,d;if(e.PolyTyp==i.PolyType.ptSubject){c=this.m_SubjFillType;p=this.m_ClipFillType}else{c=this.m_ClipFillType;p=this.m_SubjFillType}if(t.PolyTyp==i.PolyType.ptSubject){h=this.m_SubjFillType;d=this.m_ClipFillType}else{h=this.m_ClipFillType;d=this.m_SubjFillType}var v,m;switch(c){case i.PolyFillType.pftPositive:v=e.WindCnt;break;case i.PolyFillType.pftNegative:v=-e.WindCnt;break;default:v=Math.abs(e.WindCnt);break}switch(h){case i.PolyFillType.pftPositive:m=t.WindCnt;break;case i.PolyFillType.pftNegative:m=-t.WindCnt;break;default:m=Math.abs(t.WindCnt);break}if(a&&f){if(o||u||v!==0&&v!=1||m!==0&&m!=1||e.PolyTyp!=t.PolyTyp&&this.m_ClipType!=i.ClipType.ctXor)this.AddLocalMaxPoly(e,t,r);else{this.AddOutPt(e,r);this.AddOutPt(t,r);i.Clipper.SwapSides(e,t);i.Clipper.SwapPolyIndexes(e,t)}}else if(a){if(m===0||m==1){this.AddOutPt(e,r);i.Clipper.SwapSides(e,t);i.Clipper.SwapPolyIndexes(e,t)}}else if(f){if(v===0||v==1){this.AddOutPt(t,r);i.Clipper.SwapSides(e,t);i.Clipper.SwapPolyIndexes(e,t)}}else if((v===0||v==1)&&(m===0||m==1)&&!o&&!u){var g,y;switch(p){case i.PolyFillType.pftPositive:g=e.WindCnt2;break;case i.PolyFillType.pftNegative:g=-e.WindCnt2;break;default:g=Math.abs(e.WindCnt2);break}switch(d){case i.PolyFillType.pftPositive:y=t.WindCnt2;break;case i.PolyFillType.pftNegative:y=-t.WindCnt2;break;default:y=Math.abs(t.WindCnt2);break}if(e.PolyTyp!=t.PolyTyp)this.AddLocalMinPoly(e,t,r);else if(v==1&&m==1)switch(this.m_ClipType){case i.ClipType.ctIntersection:if(g>0&&y>0)this.AddLocalMinPoly(e,t,r);break;case i.ClipType.ctUnion:if(g<=0&&y<=0)this.AddLocalMinPoly(e,t,r);break;case i.ClipType.ctDifference:if(e.PolyTyp==i.PolyType.ptClip&&g>0&&y>0||e.PolyTyp==i.PolyType.ptSubject&&g<=0&&y<=0)this.AddLocalMinPoly(e,t,r);break;case i.ClipType.ctXor:this.AddLocalMinPoly(e,t,r);break}else i.Clipper.SwapSides(e,t)}if(o!=u&&(o&&e.OutIdx>=0||u&&t.OutIdx>=0)){i.Clipper.SwapSides(e,t);i.Clipper.SwapPolyIndexes(e,t)}if(o)this.DeleteFromAEL(e);if(u)this.DeleteFromAEL(t)};i.Clipper.prototype.DeleteFromAEL=function(e){var t=e.PrevInAEL;var n=e.NextInAEL;if(t===null&&n===null&&e!=this.m_ActiveEdges)return;if(t!==null)t.NextInAEL=n;else this.m_ActiveEdges=n;if(n!==null)n.PrevInAEL=t;e.NextInAEL=null;e.PrevInAEL=null};i.Clipper.prototype.DeleteFromSEL=function(e){var t=e.PrevInSEL;var n=e.NextInSEL;if(t===null&&n===null&&e!=this.m_SortedEdges)return;if(t!==null)t.NextInSEL=n;else this.m_SortedEdges=n;if(n!==null)n.PrevInSEL=t;e.NextInSEL=null;e.PrevInSEL=null};i.Clipper.prototype.UpdateEdgeIntoAEL=function(e){if(e.NextInLML===null)i.Error("UpdateEdgeIntoAEL: invalid call");var t=e.PrevInAEL;var n=e.NextInAEL;e.NextInLML.OutIdx=e.OutIdx;if(t!==null)t.NextInAEL=e.NextInLML;else this.m_ActiveEdges=e.NextInLML;if(n!==null)n.PrevInAEL=e.NextInLML;e.NextInLML.Side=e.Side;e.NextInLML.WindDelta=e.WindDelta;e.NextInLML.WindCnt=e.WindCnt;e.NextInLML.WindCnt2=e.WindCnt2;e=e.NextInLML;e.Curr.X=e.Bot.X;e.Curr.Y=e.Bot.Y;e.PrevInAEL=t;e.NextInAEL=n;if(!i.ClipperBase.IsHorizontal(e))this.InsertScanbeam(e.Top.Y);return e};i.Clipper.prototype.ProcessHorizontals=function(e){var t=this.m_SortedEdges;while(t!==null){this.DeleteFromSEL(t);this.ProcessHorizontal(t,e);t=this.m_SortedEdges}};i.Clipper.prototype.GetHorzDirection=function(e,t){if(e.Bot.X<e.Top.X){t.Left=e.Bot.X;t.Right=e.Top.X;t.Dir=i.Direction.dLeftToRight}else{t.Left=e.Top.X;t.Right=e.Bot.X;t.Dir=i.Direction.dRightToLeft}};i.Clipper.prototype.PrepareHorzJoins=function(e,t){var n=this.m_PolyOuts[e.OutIdx].Pts;if(e.Side!=i.EdgeSide.esLeft)n=n.Prev;if(t)if(i.IntPoint.op_Equality(n.Pt,e.Top))this.AddGhostJoin(n,e.Bot);else this.AddGhostJoin(n,e.Top)};i.Clipper.prototype.ProcessHorizontal=function(e,t){var n={Dir:null,Left:null,Right:null};this.GetHorzDirection(e,n);var r=n.Dir;var s=n.Left;var o=n.Right;var u=e,a=null;while(u.NextInLML!==null&&i.ClipperBase.IsHorizontal(u.NextInLML))u=u.NextInLML;if(u.NextInLML===null)a=this.GetMaximaPair(u);for(;;){var f=e==u;var l=this.GetNextInAEL(e,r);while(l!==null){if(l.Curr.X==e.Top.X&&e.NextInLML!==null&&l.Dx<e.NextInLML.Dx)break;var c=this.GetNextInAEL(l,r);if(r==i.Direction.dLeftToRight&&l.Curr.X<=o||r==i.Direction.dRightToLeft&&l.Curr.X>=s){if(e.OutIdx>=0&&e.WindDelta!=0)this.PrepareHorzJoins(e,t);if(l==a&&f){if(r==i.Direction.dLeftToRight)this.IntersectEdges(e,l,l.Top,false);else this.IntersectEdges(l,e,l.Top,false);if(a.OutIdx>=0)i.Error("ProcessHorizontal error");return}else if(r==i.Direction.dLeftToRight){var h=new i.IntPoint(l.Curr.X,e.Curr.Y);this.IntersectEdges(e,l,h,true)}else{var h=new i.IntPoint(l.Curr.X,e.Curr.Y);this.IntersectEdges(l,e,h,true)}this.SwapPositionsInAEL(e,l)}else if(r==i.Direction.dLeftToRight&&l.Curr.X>=o||r==i.Direction.dRightToLeft&&l.Curr.X<=s)break;l=c}if(e.OutIdx>=0&&e.WindDelta!==0)this.PrepareHorzJoins(e,t);if(e.NextInLML!==null&&i.ClipperBase.IsHorizontal(e.NextInLML)){e=this.UpdateEdgeIntoAEL(e);if(e.OutIdx>=0)this.AddOutPt(e,e.Bot);var n={Dir:r,Left:s,Right:o};this.GetHorzDirection(e,n);r=n.Dir;s=n.Left;o=n.Right}else break}if(e.NextInLML!==null){if(e.OutIdx>=0){var p=this.AddOutPt(e,e.Top);e=this.UpdateEdgeIntoAEL(e);if(e.WindDelta===0)return;var d=e.PrevInAEL;var c=e.NextInAEL;if(d!==null&&d.Curr.X==e.Bot.X&&d.Curr.Y==e.Bot.Y&&d.WindDelta!==0&&d.OutIdx>=0&&d.Curr.Y>d.Top.Y&&i.ClipperBase.SlopesEqual(e,d,this.m_UseFullRange)){var v=this.AddOutPt(d,e.Bot);this.AddJoin(p,v,e.Top)}else if(c!==null&&c.Curr.X==e.Bot.X&&c.Curr.Y==e.Bot.Y&&c.WindDelta!==0&&c.OutIdx>=0&&c.Curr.Y>c.Top.Y&&i.ClipperBase.SlopesEqual(e,c,this.m_UseFullRange)){var v=this.AddOutPt(c,e.Bot);this.AddJoin(p,v,e.Top)}}else e=this.UpdateEdgeIntoAEL(e)}else if(a!==null){if(a.OutIdx>=0){if(r==i.Direction.dLeftToRight)this.IntersectEdges(e,a,e.Top,false);else this.IntersectEdges(a,e,e.Top,false);if(a.OutIdx>=0)i.Error("ProcessHorizontal error")}else{this.DeleteFromAEL(e);this.DeleteFromAEL(a)}}else{if(e.OutIdx>=0)this.AddOutPt(e,e.Top);this.DeleteFromAEL(e)}};i.Clipper.prototype.GetNextInAEL=function(e,t){return t==i.Direction.dLeftToRight?e.NextInAEL:e.PrevInAEL};i.Clipper.prototype.IsMinima=function(e){return e!==null&&e.Prev.NextInLML!=e&&e.Next.NextInLML!=e};i.Clipper.prototype.IsMaxima=function(e,t){return e!==null&&e.Top.Y==t&&e.NextInLML===null};i.Clipper.prototype.IsIntermediate=function(e,t){return e.Top.Y==t&&e.NextInLML!==null};i.Clipper.prototype.GetMaximaPair=function(e){var t=null;if(i.IntPoint.op_Equality(e.Next.Top,e.Top)&&e.Next.NextInLML===null)t=e.Next;else if(i.IntPoint.op_Equality(e.Prev.Top,e.Top)&&e.Prev.NextInLML===null)t=e.Prev;if(t!==null&&(t.OutIdx==-2||t.NextInAEL==t.PrevInAEL&&!i.ClipperBase.IsHorizontal(t)))return null;return t};i.Clipper.prototype.ProcessIntersections=function(e,t){if(this.m_ActiveEdges==null)return true;try{this.BuildIntersectList(e,t);if(this.m_IntersectList.length==0)return true;if(this.m_IntersectList.length==1||this.FixupIntersectionOrder())this.ProcessIntersectList();else return false}catch(n){this.m_SortedEdges=null;this.m_IntersectList.length=0;i.Error("ProcessIntersections error")}this.m_SortedEdges=null;return true};i.Clipper.prototype.BuildIntersectList=function(e,t){if(this.m_ActiveEdges===null)return;var n=this.m_ActiveEdges;this.m_SortedEdges=n;while(n!==null){n.PrevInSEL=n.PrevInAEL;n.NextInSEL=n.NextInAEL;n.Curr.X=i.Clipper.TopX(n,t);n=n.NextInAEL}var r=true;while(r&&this.m_SortedEdges!==null){r=false;n=this.m_SortedEdges;while(n.NextInSEL!==null){var s=n.NextInSEL;var o=new i.IntPoint;if(n.Curr.X>s.Curr.X){if(!this.IntersectPoint(n,s,o)&&n.Curr.X>s.Curr.X+1){i.Error("Intersection error")}if(o.Y>e){o.Y=e;if(Math.abs(n.Dx)>Math.abs(s.Dx))o.X=i.Clipper.TopX(s,e);else o.X=i.Clipper.TopX(n,e)}var u=new i.IntersectNode;u.Edge1=n;u.Edge2=s;u.Pt.X=o.X;u.Pt.Y=o.Y;this.m_IntersectList.push(u);this.SwapPositionsInSEL(n,s);r=true}else n=s}if(n.PrevInSEL!==null)n.PrevInSEL.NextInSEL=null;else break}this.m_SortedEdges=null};i.Clipper.prototype.EdgesAdjacent=function(e){return e.Edge1.NextInSEL==e.Edge2||e.Edge1.PrevInSEL==e.Edge2};i.Clipper.IntersectNodeSort=function(e,t){return t.Pt.Y-e.Pt.Y};i.Clipper.prototype.FixupIntersectionOrder=function(){this.m_IntersectList.sort(this.m_IntersectNodeComparer);this.CopyAELToSEL();var e=this.m_IntersectList.length;for(var t=0;t<e;t++){if(!this.EdgesAdjacent(this.m_IntersectList[t])){var n=t+1;while(n<e&&!this.EdgesAdjacent(this.m_IntersectList[n]))n++;if(n==e)return false;var r=this.m_IntersectList[t];this.m_IntersectList[t]=this.m_IntersectList[n];this.m_IntersectList[n]=r}this.SwapPositionsInSEL(this.m_IntersectList[t].Edge1,this.m_IntersectList[t].Edge2)}return true};i.Clipper.prototype.ProcessIntersectList=function(){for(var e=0,t=this.m_IntersectList.length;e<t;e++){var n=this.m_IntersectList[e];this.IntersectEdges(n.Edge1,n.Edge2,n.Pt,true);this.SwapPositionsInAEL(n.Edge1,n.Edge2)}this.m_IntersectList.length=0};var bn=function(e){return e<0?Math.ceil(e-.5):Math.round(e)};var wn=function(e){return e<0?Math.ceil(e-.5):Math.floor(e+.5)};var En=function(e){return e<0?-Math.round(Math.abs(e)):Math.round(e)};var Sn=function(e){if(e<0){e-=.5;return e<-2147483648?Math.ceil(e):e|0}else{e+=.5;return e>2147483647?Math.floor(e):e|0}};if(u.msie)i.Clipper.Round=bn;else if(u.chromium)i.Clipper.Round=En;else if(u.safari)i.Clipper.Round=Sn;else i.Clipper.Round=wn;i.Clipper.TopX=function(e,t){if(t==e.Top.Y)return e.Top.X;return e.Bot.X+i.Clipper.Round(e.Dx*(t-e.Bot.Y))};i.Clipper.prototype.IntersectPoint=function(e,t,n){n.X=0;n.Y=0;var r,s;if(i.ClipperBase.SlopesEqual(e,t,this.m_UseFullRange)||e.Dx==t.Dx){if(t.Bot.Y>e.Bot.Y){n.X=t.Bot.X;n.Y=t.Bot.Y}else{n.X=e.Bot.X;n.Y=e.Bot.Y}return false}else if(e.Delta.X===0){n.X=e.Bot.X;if(i.ClipperBase.IsHorizontal(t)){n.Y=t.Bot.Y}else{s=t.Bot.Y-t.Bot.X/t.Dx;n.Y=i.Clipper.Round(n.X/t.Dx+s)}}else if(t.Delta.X===0){n.X=t.Bot.X;if(i.ClipperBase.IsHorizontal(e)){n.Y=e.Bot.Y}else{r=e.Bot.Y-e.Bot.X/e.Dx;n.Y=i.Clipper.Round(n.X/e.Dx+r)}}else{r=e.Bot.X-e.Bot.Y*e.Dx;s=t.Bot.X-t.Bot.Y*t.Dx;var o=(s-r)/(e.Dx-t.Dx);n.Y=i.Clipper.Round(o);if(Math.abs(e.Dx)<Math.abs(t.Dx))n.X=i.Clipper.Round(e.Dx*o+r);else n.X=i.Clipper.Round(t.Dx*o+s)}if(n.Y<e.Top.Y||n.Y<t.Top.Y){if(e.Top.Y>t.Top.Y){n.Y=e.Top.Y;n.X=i.Clipper.TopX(t,e.Top.Y);return n.X<e.Top.X}else n.Y=t.Top.Y;if(Math.abs(e.Dx)<Math.abs(t.Dx))n.X=i.Clipper.TopX(e,n.Y);else n.X=i.Clipper.TopX(t,n.Y)}return true};i.Clipper.prototype.ProcessEdgesAtTopOfScanbeam=function(e){var t=this.m_ActiveEdges;while(t!==null){var n=this.IsMaxima(t,e);if(n){var r=this.GetMaximaPair(t);n=r===null||!i.ClipperBase.IsHorizontal(r)}if(n){var s=t.PrevInAEL;this.DoMaxima(t);if(s===null)t=this.m_ActiveEdges;else t=s.NextInAEL}else{if(this.IsIntermediate(t,e)&&i.ClipperBase.IsHorizontal(t.NextInLML)){t=this.UpdateEdgeIntoAEL(t);if(t.OutIdx>=0)this.AddOutPt(t,t.Bot);this.AddEdgeToSEL(t)}else{t.Curr.X=i.Clipper.TopX(t,e);t.Curr.Y=e}if(this.StrictlySimple){var s=t.PrevInAEL;if(t.OutIdx>=0&&t.WindDelta!==0&&s!==null&&s.OutIdx>=0&&s.Curr.X==t.Curr.X&&s.WindDelta!==0){var o=this.AddOutPt(s,t.Curr);var u=this.AddOutPt(t,t.Curr);this.AddJoin(o,u,t.Curr)}}t=t.NextInAEL}}this.ProcessHorizontals(true);t=this.m_ActiveEdges;while(t!==null){if(this.IsIntermediate(t,e)){var o=null;if(t.OutIdx>=0)o=this.AddOutPt(t,t.Top);t=this.UpdateEdgeIntoAEL(t);var s=t.PrevInAEL;var a=t.NextInAEL;if(s!==null&&s.Curr.X==t.Bot.X&&s.Curr.Y==t.Bot.Y&&o!==null&&s.OutIdx>=0&&s.Curr.Y>s.Top.Y&&i.ClipperBase.SlopesEqual(t,s,this.m_UseFullRange)&&t.WindDelta!==0&&s.WindDelta!==0){var u=this.AddOutPt(s,t.Bot);this.AddJoin(o,u,t.Top)}else if(a!==null&&a.Curr.X==t.Bot.X&&a.Curr.Y==t.Bot.Y&&o!==null&&a.OutIdx>=0&&a.Curr.Y>a.Top.Y&&i.ClipperBase.SlopesEqual(t,a,this.m_UseFullRange)&&t.WindDelta!==0&&a.WindDelta!==0){var u=this.AddOutPt(a,t.Bot);this.AddJoin(o,u,t.Top)}}t=t.NextInAEL}};i.Clipper.prototype.DoMaxima=function(e){var t=this.GetMaximaPair(e);if(t===null){if(e.OutIdx>=0)this.AddOutPt(e,e.Top);this.DeleteFromAEL(e);return}var n=e.NextInAEL;var r=true;while(n!==null&&n!=t){this.IntersectEdges(e,n,e.Top,true);this.SwapPositionsInAEL(e,n);n=e.NextInAEL}if(e.OutIdx==-1&&t.OutIdx==-1){this.DeleteFromAEL(e);this.DeleteFromAEL(t)}else if(e.OutIdx>=0&&t.OutIdx>=0){this.IntersectEdges(e,t,e.Top,false)}else if(r&&e.WindDelta===0){if(e.OutIdx>=0){this.AddOutPt(e,e.Top);e.OutIdx=-1}this.DeleteFromAEL(e);if(t.OutIdx>=0){this.AddOutPt(t,e.Top);t.OutIdx=-1}this.DeleteFromAEL(t)}else i.Error("DoMaxima error")};i.Clipper.ReversePaths=function(e){for(var t=0,n=e.length;t<n;t++)e[t].reverse()};i.Clipper.Orientation=function(e){return i.Clipper.Area(e)>=0};i.Clipper.prototype.PointCount=function(e){if(e===null)return 0;var t=0;var n=e;do{t++;n=n.Next}while(n!=e);return t};i.Clipper.prototype.BuildResult=function(e){i.Clear(e);for(var t=0,n=this.m_PolyOuts.length;t<n;t++){var r=this.m_PolyOuts[t];if(r.Pts===null)continue;var s=r.Pts.Prev;var o=this.PointCount(s);if(o<2)continue;var u=new Array(o);for(var a=0;a<o;a++){u[a]=s.Pt;s=s.Prev}e.push(u)}};i.Clipper.prototype.BuildResult2=function(e){e.Clear();for(var t=0,n=this.m_PolyOuts.length;t<n;t++){var r=this.m_PolyOuts[t];var s=this.PointCount(r.Pts);if(r.IsOpen&&s<2||!r.IsOpen&&s<3)continue;this.FixHoleLinkage(r);var o=new i.PolyNode;e.m_AllPolys.push(o);r.PolyNode=o;o.m_polygon.length=s;var u=r.Pts.Prev;for(var a=0;a<s;a++){o.m_polygon[a]=u.Pt;u=u.Prev}}for(var t=0,n=this.m_PolyOuts.length;t<n;t++){var r=this.m_PolyOuts[t];if(r.PolyNode===null)continue;else if(r.IsOpen){r.PolyNode.IsOpen=true;e.AddChild(r.PolyNode)}else if(r.FirstLeft!==null&&r.FirstLeft.PolyNode!=null)r.FirstLeft.PolyNode.AddChild(r.PolyNode);else e.AddChild(r.PolyNode)}};i.Clipper.prototype.FixupOutPolygon=function(e){var t=null;e.BottomPt=null;var n=e.Pts;for(;;){if(n.Prev==n||n.Prev==n.Next){this.DisposeOutPts(n);e.Pts=null;return}if(i.IntPoint.op_Equality(n.Pt,n.Next.Pt)||i.IntPoint.op_Equality(n.Pt,n.Prev.Pt)||i.ClipperBase.SlopesEqual(n.Prev.Pt,n.Pt,n.Next.Pt,this.m_UseFullRange)&&(!this.PreserveCollinear||!this.Pt2IsBetweenPt1AndPt3(n.Prev.Pt,n.Pt,n.Next.Pt))){t=null;var r=n;n.Prev.Next=n.Next;n.Next.Prev=n.Prev;n=n.Prev;r=null}else if(n==t)break;else{if(t===null)t=n;n=n.Next}}e.Pts=n};i.Clipper.prototype.DupOutPt=function(e,t){var n=new i.OutPt;n.Pt.X=e.Pt.X;n.Pt.Y=e.Pt.Y;n.Idx=e.Idx;if(t){n.Next=e.Next;n.Prev=e;e.Next.Prev=n;e.Next=n}else{n.Prev=e.Prev;n.Next=e;e.Prev.Next=n;e.Prev=n}return n};i.Clipper.prototype.GetOverlap=function(e,t,n,r,i){if(e<t){if(n<r){i.Left=Math.max(e,n);i.Right=Math.min(t,r)}else{i.Left=Math.max(e,r);i.Right=Math.min(t,n)}}else{if(n<r){i.Left=Math.max(t,n);i.Right=Math.min(e,r)}else{i.Left=Math.max(t,r);i.Right=Math.min(e,n)}}return i.Left<i.Right};i.Clipper.prototype.JoinHorz=function(e,t,n,r,s,o){var u=e.Pt.X>t.Pt.X?i.Direction.dRightToLeft:i.Direction.dLeftToRight;var a=n.Pt.X>r.Pt.X?i.Direction.dRightToLeft:i.Direction.dLeftToRight;if(u==a)return false;if(u==i.Direction.dLeftToRight){while(e.Next.Pt.X<=s.X&&e.Next.Pt.X>=e.Pt.X&&e.Next.Pt.Y==s.Y)e=e.Next;if(o&&e.Pt.X!=s.X)e=e.Next;t=this.DupOutPt(e,!o);if(i.IntPoint.op_Inequality(t.Pt,s)){e=t;e.Pt.X=s.X;e.Pt.Y=s.Y;t=this.DupOutPt(e,!o)}}else{while(e.Next.Pt.X>=s.X&&e.Next.Pt.X<=e.Pt.X&&e.Next.Pt.Y==s.Y)e=e.Next;if(!o&&e.Pt.X!=s.X)e=e.Next;t=this.DupOutPt(e,o);if(i.IntPoint.op_Inequality(t.Pt,s)){e=t;e.Pt.X=s.X;e.Pt.Y=s.Y;t=this.DupOutPt(e,o)}}if(a==i.Direction.dLeftToRight){while(n.Next.Pt.X<=s.X&&n.Next.Pt.X>=n.Pt.X&&n.Next.Pt.Y==s.Y)n=n.Next;if(o&&n.Pt.X!=s.X)n=n.Next;r=this.DupOutPt(n,!o);if(i.IntPoint.op_Inequality(r.Pt,s)){n=r;n.Pt.X=s.X;n.Pt.Y=s.Y;r=this.DupOutPt(n,!o)}}else{while(n.Next.Pt.X>=s.X&&n.Next.Pt.X<=n.Pt.X&&n.Next.Pt.Y==s.Y)n=n.Next;if(!o&&n.Pt.X!=s.X)n=n.Next;r=this.DupOutPt(n,o);if(i.IntPoint.op_Inequality(r.Pt,s)){n=r;n.Pt.X=s.X;n.Pt.Y=s.Y;r=this.DupOutPt(n,o)}}if(u==i.Direction.dLeftToRight==o){e.Prev=n;n.Next=e;t.Next=r;r.Prev=t}else{e.Next=n;n.Prev=e;t.Prev=r;r.Next=t}return true};i.Clipper.prototype.JoinPoints=function(e,t,n){var r=e.OutPt1,s=new i.OutPt;var o=e.OutPt2,u=new i.OutPt;var a=e.OutPt1.Pt.Y==e.OffPt.Y;if(a&&i.IntPoint.op_Equality(e.OffPt,e.OutPt1.Pt)&&i.IntPoint.op_Equality(e.OffPt,e.OutPt2.Pt)){s=e.OutPt1.Next;while(s!=r&&i.IntPoint.op_Equality(s.Pt,e.OffPt))s=s.Next;var f=s.Pt.Y>e.OffPt.Y;u=e.OutPt2.Next;while(u!=o&&i.IntPoint.op_Equality(u.Pt,e.OffPt))u=u.Next;var l=u.Pt.Y>e.OffPt.Y;if(f==l)return false;if(f){s=this.DupOutPt(r,false);u=this.DupOutPt(o,true);r.Prev=o;o.Next=r;s.Next=u;u.Prev=s;e.OutPt1=r;e.OutPt2=s;return true}else{s=this.DupOutPt(r,true);u=this.DupOutPt(o,false);r.Next=o;o.Prev=r;s.Prev=u;u.Next=s;e.OutPt1=r;e.OutPt2=s;return true}}else if(a){s=r;while(r.Prev.Pt.Y==r.Pt.Y&&r.Prev!=s&&r.Prev!=o)r=r.Prev;while(s.Next.Pt.Y==s.Pt.Y&&s.Next!=r&&s.Next!=o)s=s.Next;if(s.Next==r||s.Next==o)return false;u=o;while(o.Prev.Pt.Y==o.Pt.Y&&o.Prev!=u&&o.Prev!=s)o=o.Prev;while(u.Next.Pt.Y==u.Pt.Y&&u.Next!=o&&u.Next!=r)u=u.Next;if(u.Next==o||u.Next==r)return false;var c={Left:null,Right:null};if(!this.GetOverlap(r.Pt.X,s.Pt.X,o.Pt.X,u.Pt.X,c))return false;var h=c.Left;var p=c.Right;var d=new i.IntPoint;var v;if(r.Pt.X>=h&&r.Pt.X<=p){d.X=r.Pt.X;d.Y=r.Pt.Y;v=r.Pt.X>s.Pt.X}else if(o.Pt.X>=h&&o.Pt.X<=p){d.X=o.Pt.X;d.Y=o.Pt.Y;v=o.Pt.X>u.Pt.X}else if(s.Pt.X>=h&&s.Pt.X<=p){d.X=s.Pt.X;d.Y=s.Pt.Y;v=s.Pt.X>r.Pt.X}else{d.X=u.Pt.X;d.Y=u.Pt.Y;v=u.Pt.X>o.Pt.X}e.OutPt1=r;e.OutPt2=o;return this.JoinHorz(r,s,o,u,d,v)}else{s=r.Next;while(i.IntPoint.op_Equality(s.Pt,r.Pt)&&s!=r)s=s.Next;var m=s.Pt.Y>r.Pt.Y||!i.ClipperBase.SlopesEqual(r.Pt,s.Pt,e.OffPt,this.m_UseFullRange);if(m){s=r.Prev;while(i.IntPoint.op_Equality(s.Pt,r.Pt)&&s!=r)s=s.Prev;if(s.Pt.Y>r.Pt.Y||!i.ClipperBase.SlopesEqual(r.Pt,s.Pt,e.OffPt,this.m_UseFullRange))return false}u=o.Next;while(i.IntPoint.op_Equality(u.Pt,o.Pt)&&u!=o)u=u.Next;var g=u.Pt.Y>o.Pt.Y||!i.ClipperBase.SlopesEqual(o.Pt,u.Pt,e.OffPt,this.m_UseFullRange);if(g){u=o.Prev;while(i.IntPoint.op_Equality(u.Pt,o.Pt)&&u!=o)u=u.Prev;if(u.Pt.Y>o.Pt.Y||!i.ClipperBase.SlopesEqual(o.Pt,u.Pt,e.OffPt,this.m_UseFullRange))return false}if(s==r||u==o||s==u||t==n&&m==g)return false;if(m){s=this.DupOutPt(r,false);u=this.DupOutPt(o,true);r.Prev=o;o.Next=r;s.Next=u;u.Prev=s;e.OutPt1=r;e.OutPt2=s;return true}else{s=this.DupOutPt(r,true);u=this.DupOutPt(o,false);r.Next=o;o.Prev=r;s.Prev=u;u.Next=s;e.OutPt1=r;e.OutPt2=s;return true}}};i.Clipper.GetBounds=function(e){var t=0,n=e.length;while(t<n&&e[t].length==0)t++;if(t==n)return new i.IntRect(0,0,0,0);var r=new i.IntRect;r.left=e[t][0].X;r.right=r.left;r.top=e[t][0].Y;r.bottom=r.top;for(;t<n;t++)for(var s=0,o=e[t].length;s<o;s++){if(e[t][s].X<r.left)r.left=e[t][s].X;else if(e[t][s].X>r.right)r.right=e[t][s].X;if(e[t][s].Y<r.top)r.top=e[t][s].Y;else if(e[t][s].Y>r.bottom)r.bottom=e[t][s].Y}return r};i.Clipper.prototype.GetBounds2=function(e){var t=e;var n=new i.IntRect;n.left=e.Pt.X;n.right=e.Pt.X;n.top=e.Pt.Y;n.bottom=e.Pt.Y;e=e.Next;while(e!=t){if(e.Pt.X<n.left)n.left=e.Pt.X;if(e.Pt.X>n.right)n.right=e.Pt.X;if(e.Pt.Y<n.top)n.top=e.Pt.Y;if(e.Pt.Y>n.bottom)n.bottom=e.Pt.Y;e=e.Next}return n};i.Clipper.PointInPolygon=function(e,t){var n=0,r=t.length;if(r<3)return 0;var i=t[0];for(var s=1;s<=r;++s){var o=s==r?t[0]:t[s];if(o.Y==e.Y){if(o.X==e.X||i.Y==e.Y&&o.X>e.X==i.X<e.X)return-1}if(i.Y<e.Y!=o.Y<e.Y){if(i.X>=e.X){if(o.X>e.X)n=1-n;else{var u=(i.X-e.X)*(o.Y-e.Y)-(o.X-e.X)*(i.Y-e.Y);if(u==0)return-1;else if(u>0==o.Y>i.Y)n=1-n}}else{if(o.X>e.X){var u=(i.X-e.X)*(o.Y-e.Y)-(o.X-e.X)*(i.Y-e.Y);if(u==0)return-1;else if(u>0==o.Y>i.Y)n=1-n}}}i=o}return n};i.Clipper.prototype.PointInPolygon=function(e,t){var n=0;var r=t;for(;;){var i=t.Pt.X,s=t.Pt.Y;var o=t.Next.Pt.X,u=t.Next.Pt.Y;if(u==e.Y){if(o==e.X||s==e.Y&&o>e.X==i<e.X)return-1}if(s<e.Y!=u<e.Y){if(i>=e.X){if(o>e.X)n=1-n;else{var a=(i-e.X)*(u-e.Y)-(o-e.X)*(s-e.Y);if(a==0)return-1;if(a>0==u>s)n=1-n}}else{if(o>e.X){var a=(i-e.X)*(u-e.Y)-(o-e.X)*(s-e.Y);if(a==0)return-1;if(a>0==u>s)n=1-n}}}t=t.Next;if(r==t)break}return n};i.Clipper.prototype.Poly2ContainsPoly1=function(e,t){var n=e;do{var r=this.PointInPolygon(n.Pt,t);if(r>=0)return r!=0;n=n.Next}while(n!=e);return true};i.Clipper.prototype.FixupFirstLefts1=function(e,t){for(var n=0,r=this.m_PolyOuts.length;n<r;n++){var i=this.m_PolyOuts[n];if(i.Pts!==null&&i.FirstLeft==e){if(this.Poly2ContainsPoly1(i.Pts,t.Pts))i.FirstLeft=t}}};i.Clipper.prototype.FixupFirstLefts2=function(e,t){for(var n=0,r=this.m_PolyOuts,i=r.length,s=r[n];n<i;n++,s=r[n])if(s.FirstLeft==e)s.FirstLeft=t};i.Clipper.ParseFirstLeft=function(e){while(e!=null&&e.Pts==null)e=e.FirstLeft;return e};i.Clipper.prototype.JoinCommonEdges=function(){for(var e=0,t=this.m_Joins.length;e<t;e++){var n=this.m_Joins[e];var r=this.GetOutRec(n.OutPt1.Idx);var s=this.GetOutRec(n.OutPt2.Idx);if(r.Pts==null||s.Pts==null)continue;var o;if(r==s)o=r;else if(this.Param1RightOfParam2(r,s))o=s;else if(this.Param1RightOfParam2(s,r))o=r;else o=this.GetLowermostRec(r,s);if(!this.JoinPoints(n,r,s))continue;if(r==s){r.Pts=n.OutPt1;r.BottomPt=null;s=this.CreateOutRec();s.Pts=n.OutPt2;this.UpdateOutPtIdxs(s);if(this.m_UsingPolyTree)for(var u=0,a=this.m_PolyOuts.length;u<a-1;u++){var f=this.m_PolyOuts[u];if(f.Pts==null||i.Clipper.ParseFirstLeft(f.FirstLeft)!=r||f.IsHole==r.IsHole)continue;if(this.Poly2ContainsPoly1(f.Pts,n.OutPt2))f.FirstLeft=s}if(this.Poly2ContainsPoly1(s.Pts,r.Pts)){s.IsHole=!r.IsHole;s.FirstLeft=r;if(this.m_UsingPolyTree)this.FixupFirstLefts2(s,r);if((s.IsHole^this.ReverseSolution)==this.Area(s)>0)this.ReversePolyPtLinks(s.Pts)}else if(this.Poly2ContainsPoly1(r.Pts,s.Pts)){s.IsHole=r.IsHole;r.IsHole=!s.IsHole;s.FirstLeft=r.FirstLeft;r.FirstLeft=s;if(this.m_UsingPolyTree)this.FixupFirstLefts2(r,s);if((r.IsHole^this.ReverseSolution)==this.Area(r)>0)this.ReversePolyPtLinks(r.Pts)}else{s.IsHole=r.IsHole;s.FirstLeft=r.FirstLeft;if(this.m_UsingPolyTree)this.FixupFirstLefts1(r,s)}}else{s.Pts=null;s.BottomPt=null;s.Idx=r.Idx;r.IsHole=o.IsHole;if(o==s)r.FirstLeft=s.FirstLeft;s.FirstLeft=r;if(this.m_UsingPolyTree)this.FixupFirstLefts2(s,r)}}};i.Clipper.prototype.UpdateOutPtIdxs=function(e){var t=e.Pts;do{t.Idx=e.Idx;t=t.Prev}while(t!=e.Pts)};i.Clipper.prototype.DoSimplePolygons=function(){var e=0;while(e<this.m_PolyOuts.length){var t=this.m_PolyOuts[e++];var n=t.Pts;if(n===null)continue;do{var r=n.Next;while(r!=t.Pts){if(i.IntPoint.op_Equality(n.Pt,r.Pt)&&r.Next!=n&&r.Prev!=n){var s=n.Prev;var o=r.Prev;n.Prev=o;o.Next=n;r.Prev=s;s.Next=r;t.Pts=n;var u=this.CreateOutRec();u.Pts=r;this.UpdateOutPtIdxs(u);if(this.Poly2ContainsPoly1(u.Pts,t.Pts)){u.IsHole=!t.IsHole;u.FirstLeft=t}else if(this.Poly2ContainsPoly1(t.Pts,u.Pts)){u.IsHole=t.IsHole;t.IsHole=!u.IsHole;u.FirstLeft=t.FirstLeft;t.FirstLeft=u}else{u.IsHole=t.IsHole;u.FirstLeft=t.FirstLeft}r=n}r=r.Next}n=n.Next}while(n!=t.Pts)}};i.Clipper.Area=function(e){var t=e.length;if(t<3)return 0;var n=0;for(var r=0,i=t-1;r<t;++r){n+=(e[i].X+e[r].X)*(e[i].Y-e[r].Y);i=r}return-n*.5};i.Clipper.prototype.Area=function(e){var t=e.Pts;if(t==null)return 0;var n=0;do{n=n+(t.Prev.Pt.X+t.Pt.X)*(t.Prev.Pt.Y-t.Pt.Y);t=t.Next}while(t!=e.Pts);return n*.5};if(r){i.Clipper.OffsetPaths=function(e,t,n,r,s){var o=new i.Paths;var u=new i.ClipperOffset(s,s);u.AddPaths(e,n,r);u.Execute(o,t);return o}}i.Clipper.SimplifyPolygon=function(e,t){var n=new Array;var r=new i.Clipper(0);r.StrictlySimple=true;r.AddPath(e,i.PolyType.ptSubject,true);r.Execute(i.ClipType.ctUnion,n,t,t);return n};i.Clipper.SimplifyPolygons=function(e,t){if(typeof t=="undefined")t=i.PolyFillType.pftEvenOdd;var n=new Array;var r=new i.Clipper(0);r.StrictlySimple=true;r.AddPaths(e,i.PolyType.ptSubject,true);r.Execute(i.ClipType.ctUnion,n,t,t);return n};i.Clipper.DistanceSqrd=function(e,t){var n=e.X-t.X;var r=e.Y-t.Y;return n*n+r*r};i.Clipper.DistanceFromLineSqrd=function(e,t,n){var r=t.Y-n.Y;var i=n.X-t.X;var s=r*t.X+i*t.Y;s=r*e.X+i*e.Y-s;return s*s/(r*r+i*i)};i.Clipper.SlopesNearCollinear=function(e,t,n,r){return i.Clipper.DistanceFromLineSqrd(t,e,n)<r};i.Clipper.PointsAreClose=function(e,t,n){var r=e.X-t.X;var i=e.Y-t.Y;return r*r+i*i<=n};i.Clipper.ExcludeOp=function(e){var t=e.Prev;t.Next=e.Next;e.Next.Prev=t;t.Idx=0;return t};i.Clipper.CleanPolygon=function(e,t){if(typeof t=="undefined")t=1.415;var n=e.length;if(n==0)return new Array;var r=new Array(n);for(var s=0;s<n;++s)r[s]=new i.OutPt;for(var s=0;s<n;++s){r[s].Pt=e[s];r[s].Next=r[(s+1)%n];r[s].Next.Prev=r[s];r[s].Idx=0}var o=t*t;var u=r[0];while(u.Idx==0&&u.Next!=u.Prev){if(i.Clipper.PointsAreClose(u.Pt,u.Prev.Pt,o)){u=i.Clipper.ExcludeOp(u);n--}else if(i.Clipper.PointsAreClose(u.Prev.Pt,u.Next.Pt,o)){i.Clipper.ExcludeOp(u.Next);u=i.Clipper.ExcludeOp(u);n-=2}else if(i.Clipper.SlopesNearCollinear(u.Prev.Pt,u.Pt,u.Next.Pt,o)){u=i.Clipper.ExcludeOp(u);n--}else{u.Idx=1;u=u.Next}}if(n<3)n=0;var a=new Array(n);for(var s=0;s<n;++s){a[s]=new i.IntPoint(u.Pt);u=u.Next}r=null;return a};i.Clipper.CleanPolygons=function(e,t){var n=new Array(e.length);for(var r=0,s=e.length;r<s;r++)n[r]=i.Clipper.CleanPolygon(e[r],t);return n};i.Clipper.Minkowski=function(e,t,n,r){var s=r?1:0;var o=e.length;var u=t.length;var a=new Array;if(n)for(var f=0;f<u;f++){var l=new Array(o);for(var c=0,h=e.length,p=e[c];c<h;c++,p=e[c])l[c]=new i.IntPoint(t[f].X+p.X,t[f].Y+p.Y);a.push(l)}else for(var f=0;f<u;f++){var l=new Array(o);for(var c=0,h=e.length,p=e[c];c<h;c++,p=e[c])l[c]=new i.IntPoint(t[f].X-p.X,t[f].Y-p.Y);a.push(l)}var d=new Array;for(var f=0;f<u-1+s;f++)for(var c=0;c<o;c++){var v=new Array;v.push(a[f%u][c%o]);v.push(a[(f+1)%u][c%o]);v.push(a[(f+1)%u][(c+1)%o]);v.push(a[f%u][(c+1)%o]);if(!i.Clipper.Orientation(v))v.reverse();d.push(v)}var m=new i.Clipper(0);m.AddPaths(d,i.PolyType.ptSubject,true);m.Execute(i.ClipType.ctUnion,a,i.PolyFillType.pftNonZero,i.PolyFillType.pftNonZero);return a};i.Clipper.MinkowskiSum=function(){var e=arguments,t=e.length;if(t==3){var n=e[0],r=e[1],s=e[2];return i.Clipper.Minkowski(n,r,true,s)}else if(t==4){var n=e[0],o=e[1],u=e[2],s=e[3];var a=new i.Clipper,f;for(var l=0,c=o.length;l<c;++l){var f=i.Clipper.Minkowski(n,o[l],true,s);a.AddPaths(f,i.PolyType.ptSubject,true)}if(s)a.AddPaths(o,i.PolyType.ptClip,true);var h=new i.Paths;a.Execute(i.ClipType.ctUnion,h,u,u);return h}};i.Clipper.MinkowskiDiff=function(e,t,n){return i.Clipper.Minkowski(e,t,false,n)};i.Clipper.PolyTreeToPaths=function(e){var t=new Array;i.Clipper.AddPolyNodeToPaths(e,i.Clipper.NodeType.ntAny,t);return t};i.Clipper.AddPolyNodeToPaths=function(e,t,n){var r=true;switch(t){case i.Clipper.NodeType.ntOpen:return;case i.Clipper.NodeType.ntClosed:r=!e.IsOpen;break;default:break}if(e.m_polygon.length>0&&r)n.push(e.m_polygon);for(var s=0,o=e.Childs(),u=o.length,a=o[s];s<u;s++,a=o[s])i.Clipper.AddPolyNodeToPaths(a,t,n)};i.Clipper.OpenPathsFromPolyTree=function(e){var t=new i.Paths;for(var n=0,r=e.ChildCount();n<r;n++)if(e.Childs()[n].IsOpen)t.push(e.Childs()[n].m_polygon);return t};i.Clipper.ClosedPathsFromPolyTree=function(e){var t=new i.Paths;i.Clipper.AddPolyNodeToPaths(e,i.Clipper.NodeType.ntClosed,t);return t};yn(i.Clipper,i.ClipperBase);i.Clipper.NodeType={ntAny:0,ntOpen:1,ntClosed:2};i.ClipperOffset=function(e,t){if(typeof e=="undefined")e=2;if(typeof t=="undefined")t=i.ClipperOffset.def_arc_tolerance;this.m_destPolys=new i.Paths;this.m_srcPoly=new i.Path;this.m_destPoly=new i.Path;this.m_normals=new Array;this.m_delta=0;this.m_sinA=0;this.m_sin=0;this.m_cos=0;this.m_miterLim=0;this.m_StepsPerRad=0;this.m_lowest=new i.IntPoint;this.m_polyNodes=new i.PolyNode;this.MiterLimit=e;this.ArcTolerance=t;this.m_lowest.X=-1};i.ClipperOffset.two_pi=6.28318530717959;i.ClipperOffset.def_arc_tolerance=.25;i.ClipperOffset.prototype.Clear=function(){i.Clear(this.m_polyNodes.Childs());this.m_lowest.X=-1};i.ClipperOffset.Round=i.Clipper.Round;i.ClipperOffset.prototype.AddPath=function(e,t,n){var r=e.length-1;if(r<0)return;var s=new i.PolyNode;s.m_jointype=t;s.m_endtype=n;if(n==i.EndType.etClosedLine||n==i.EndType.etClosedPolygon)while(r>0&&i.IntPoint.op_Equality(e[0],e[r]))r--;s.m_polygon.push(e[0]);var o=0,u=0;for(var a=1;a<=r;a++)if(i.IntPoint.op_Inequality(s.m_polygon[o],e[a])){o++;s.m_polygon.push(e[a]);if(e[a].Y>s.m_polygon[u].Y||e[a].Y==s.m_polygon[u].Y&&e[a].X<s.m_polygon[u].X)u=o}if(n==i.EndType.etClosedPolygon&&o<2||n!=i.EndType.etClosedPolygon&&o<0)return;this.m_polyNodes.AddChild(s);if(n!=i.EndType.etClosedPolygon)return;if(this.m_lowest.X<0)this.m_lowest=new i.IntPoint(0,u);else{var f=this.m_polyNodes.Childs()[this.m_lowest.X].m_polygon[this.m_lowest.Y];if(s.m_polygon[u].Y>f.Y||s.m_polygon[u].Y==f.Y&&s.m_polygon[u].X<f.X)this.m_lowest=new i.IntPoint(this.m_polyNodes.ChildCount()-1,u)}};i.ClipperOffset.prototype.AddPaths=function(e,t,n){for(var r=0,i=e.length;r<i;r++)this.AddPath(e[r],t,n)};i.ClipperOffset.prototype.FixOrientations=function(){if(this.m_lowest.X>=0&&!i.Clipper.Orientation(this.m_polyNodes.Childs()[this.m_lowest.X].m_polygon)){for(var e=0;e<this.m_polyNodes.ChildCount();e++){var t=this.m_polyNodes.Childs()[e];if(t.m_endtype==i.EndType.etClosedPolygon||t.m_endtype==i.EndType.etClosedLine&&i.Clipper.Orientation(t.m_polygon))t.m_polygon.reverse()}}else{for(var e=0;e<this.m_polyNodes.ChildCount();e++){var t=this.m_polyNodes.Childs()[e];if(t.m_endtype==i.EndType.etClosedLine&&!i.Clipper.Orientation(t.m_polygon))t.m_polygon.reverse()}}};i.ClipperOffset.GetUnitNormal=function(e,t){var n=t.X-e.X;var r=t.Y-e.Y;if(n==0&&r==0)return new i.DoublePoint(0,0);var s=1/Math.sqrt(n*n+r*r);n*=s;r*=s;return new i.DoublePoint(r,-n)};i.ClipperOffset.prototype.DoOffset=function(e){this.m_destPolys=new Array;this.m_delta=e;if(i.ClipperBase.near_zero(e)){for(var t=0;t<this.m_polyNodes.ChildCount();t++){var n=this.m_polyNodes.Childs()[t];if(n.m_endtype==i.EndType.etClosedPolygon)this.m_destPolys.push(n.m_polygon)}return}if(this.MiterLimit>2)this.m_miterLim=2/(this.MiterLimit*this.MiterLimit);else this.m_miterLim=.5;var r;if(this.ArcTolerance<=0)r=i.ClipperOffset.def_arc_tolerance;else if(this.ArcTolerance>Math.abs(e)*i.ClipperOffset.def_arc_tolerance)r=Math.abs(e)*i.ClipperOffset.def_arc_tolerance;else r=this.ArcTolerance;var s=3.14159265358979/Math.acos(1-r/Math.abs(e));this.m_sin=Math.sin(i.ClipperOffset.two_pi/s);this.m_cos=Math.cos(i.ClipperOffset.two_pi/s);this.m_StepsPerRad=s/i.ClipperOffset.two_pi;if(e<0)this.m_sin=-this.m_sin;for(var t=0;t<this.m_polyNodes.ChildCount();t++){var n=this.m_polyNodes.Childs()[t];this.m_srcPoly=n.m_polygon;var o=this.m_srcPoly.length;if(o==0||e<=0&&(o<3||n.m_endtype!=i.EndType.etClosedPolygon))continue;this.m_destPoly=new Array;if(o==1){if(n.m_jointype==i.JoinType.jtRound){var u=1,a=0;for(var f=1;f<=s;f++){this.m_destPoly.push(new i.IntPoint(i.ClipperOffset.Round(this.m_srcPoly[0].X+u*e),i.ClipperOffset.Round(this.m_srcPoly[0].Y+a*e)));var l=u;u=u*this.m_cos-this.m_sin*a;a=l*this.m_sin+a*this.m_cos}}else{var u=-1,a=-1;for(var f=0;f<4;++f){this.m_destPoly.push(new i.IntPoint(i.ClipperOffset.Round(this.m_srcPoly[0].X+u*e),i.ClipperOffset.Round(this.m_srcPoly[0].Y+a*e)));if(u<0)u=1;else if(a<0)a=1;else u=-1}}this.m_destPolys.push(this.m_destPoly);continue}this.m_normals.length=0;for(var f=0;f<o-1;f++)this.m_normals.push(i.ClipperOffset.GetUnitNormal(this.m_srcPoly[f],this.m_srcPoly[f+1]));if(n.m_endtype==i.EndType.etClosedLine||n.m_endtype==i.EndType.etClosedPolygon)this.m_normals.push(i.ClipperOffset.GetUnitNormal(this.m_srcPoly[o-1],this.m_srcPoly[0]));else this.m_normals.push(new i.DoublePoint(this.m_normals[o-2]));if(n.m_endtype==i.EndType.etClosedPolygon){var c=o-1;for(var f=0;f<o;f++)c=this.OffsetPoint(f,c,n.m_jointype);this.m_destPolys.push(this.m_destPoly)}else if(n.m_endtype==i.EndType.etClosedLine){var c=o-1;for(var f=0;f<o;f++)c=this.OffsetPoint(f,c,n.m_jointype);this.m_destPolys.push(this.m_destPoly);this.m_destPoly=new Array;var h=this.m_normals[o-1];for(var f=o-1;f>0;f--)this.m_normals[f]=new i.DoublePoint(-this.m_normals[f-1].X,-this.m_normals[f-1].Y);this.m_normals[0]=new i.DoublePoint(-h.X,-h.Y);c=0;for(var f=o-1;f>=0;f--)c=this.OffsetPoint(f,c,n.m_jointype);this.m_destPolys.push(this.m_destPoly)}else{var c=0;for(var f=1;f<o-1;++f)c=this.OffsetPoint(f,c,n.m_jointype);var p;if(n.m_endtype==i.EndType.etOpenButt){var f=o-1;p=new i.IntPoint(i.ClipperOffset.Round(this.m_srcPoly[f].X+this.m_normals[f].X*e),i.ClipperOffset.Round(this.m_srcPoly[f].Y+this.m_normals[f].Y*e));this.m_destPoly.push(p);p=new i.IntPoint(i.ClipperOffset.Round(this.m_srcPoly[f].X-this.m_normals[f].X*e),i.ClipperOffset.Round(this.m_srcPoly[f].Y-this.m_normals[f].Y*e));this.m_destPoly.push(p)}else{var f=o-1;c=o-2;this.m_sinA=0;this.m_normals[f]=new i.DoublePoint(-this.m_normals[f].X,-this.m_normals[f].Y);if(n.m_endtype==i.EndType.etOpenSquare)this.DoSquare(f,c);else this.DoRound(f,c)}for(var f=o-1;f>0;f--)this.m_normals[f]=new i.DoublePoint(-this.m_normals[f-1].X,-this.m_normals[f-1].Y);this.m_normals[0]=new i.DoublePoint(-this.m_normals[1].X,-this.m_normals[1].Y);c=o-1;for(var f=c-1;f>0;--f)c=this.OffsetPoint(f,c,n.m_jointype);if(n.m_endtype==i.EndType.etOpenButt){p=new i.IntPoint(i.ClipperOffset.Round(this.m_srcPoly[0].X-this.m_normals[0].X*e),i.ClipperOffset.Round(this.m_srcPoly[0].Y-this.m_normals[0].Y*e));this.m_destPoly.push(p);p=new i.IntPoint(i.ClipperOffset.Round(this.m_srcPoly[0].X+this.m_normals[0].X*e),i.ClipperOffset.Round(this.m_srcPoly[0].Y+this.m_normals[0].Y*e));this.m_destPoly.push(p)}else{c=1;this.m_sinA=0;if(n.m_endtype==i.EndType.etOpenSquare)this.DoSquare(0,1);else this.DoRound(0,1)}this.m_destPolys.push(this.m_destPoly)}}};i.ClipperOffset.prototype.Execute=function(){var e=arguments,t=e[0]instanceof i.PolyTree;if(!t){var n=e[0],r=e[1];i.Clear(n);this.FixOrientations();this.DoOffset(r);var s=new i.Clipper(0);s.AddPaths(this.m_destPolys,i.PolyType.ptSubject,true);if(r>0){s.Execute(i.ClipType.ctUnion,n,i.PolyFillType.pftPositive,i.PolyFillType.pftPositive)}else{var o=i.Clipper.GetBounds(this.m_destPolys);var u=new i.Path;u.push(new i.IntPoint(o.left-10,o.bottom+10));u.push(new i.IntPoint(o.right+10,o.bottom+10));u.push(new i.IntPoint(o.right+10,o.top-10));u.push(new i.IntPoint(o.left-10,o.top-10));s.AddPath(u,i.PolyType.ptSubject,true);s.ReverseSolution=true;s.Execute(i.ClipType.ctUnion,n,i.PolyFillType.pftNegative,i.PolyFillType.pftNegative);if(n.length>0)n.splice(0,1)}}else{var n=e[0],r=e[1];n.Clear();this.FixOrientations();this.DoOffset(r);var s=new i.Clipper(0);s.AddPaths(this.m_destPolys,i.PolyType.ptSubject,true);if(r>0){s.Execute(i.ClipType.ctUnion,n,i.PolyFillType.pftPositive,i.PolyFillType.pftPositive)}else{var o=i.Clipper.GetBounds(this.m_destPolys);var u=new i.Path;u.push(new i.IntPoint(o.left-10,o.bottom+10));u.push(new i.IntPoint(o.right+10,o.bottom+10));u.push(new i.IntPoint(o.right+10,o.top-10));u.push(new i.IntPoint(o.left-10,o.top-10));s.AddPath(u,i.PolyType.ptSubject,true);s.ReverseSolution=true;s.Execute(i.ClipType.ctUnion,n,i.PolyFillType.pftNegative,i.PolyFillType.pftNegative);if(n.ChildCount()==1&&n.Childs()[0].ChildCount()>0){var a=n.Childs()[0];n.Childs()[0]=a.Childs()[0];for(var f=1;f<a.ChildCount();f++)n.AddChild(a.Childs()[f])}else n.Clear()}}};i.ClipperOffset.prototype.OffsetPoint=function(e,t,n){this.m_sinA=this.m_normals[t].X*this.m_normals[e].Y-this.m_normals[e].X*this.m_normals[t].Y;if(this.m_sinA<5e-5&&this.m_sinA>-5e-5)return t;else if(this.m_sinA>1)this.m_sinA=1;else if(this.m_sinA<-1)this.m_sinA=-1;if(this.m_sinA*this.m_delta<0){this.m_destPoly.push(new i.IntPoint(i.ClipperOffset.Round(this.m_srcPoly[e].X+this.m_normals[t].X*this.m_delta),i.ClipperOffset.Round(this.m_srcPoly[e].Y+this.m_normals[t].Y*this.m_delta)));this.m_destPoly.push(new i.IntPoint(this.m_srcPoly[e]));this.m_destPoly.push(new i.IntPoint(i.ClipperOffset.Round(this.m_srcPoly[e].X+this.m_normals[e].X*this.m_delta),i.ClipperOffset.Round(this.m_srcPoly[e].Y+this.m_normals[e].Y*this.m_delta)))}else switch(n){case i.JoinType.jtMiter:{var r=1+(this.m_normals[e].X*this.m_normals[t].X+this.m_normals[e].Y*this.m_normals[t].Y);if(r>=this.m_miterLim)this.DoMiter(e,t,r);else this.DoSquare(e,t);break};case i.JoinType.jtSquare:this.DoSquare(e,t);break;case i.JoinType.jtRound:this.DoRound(e,t);break}t=e;return t};i.ClipperOffset.prototype.DoSquare=function(e,t){var n=Math.tan(Math.atan2(this.m_sinA,this.m_normals[t].X*this.m_normals[e].X+this.m_normals[t].Y*this.m_normals[e].Y)/4);this.m_destPoly.push(new i.IntPoint(i.ClipperOffset.Round(this.m_srcPoly[e].X+this.m_delta*(this.m_normals[t].X-this.m_normals[t].Y*n)),i.ClipperOffset.Round(this.m_srcPoly[e].Y+this.m_delta*(this.m_normals[t].Y+this.m_normals[t].X*n))));this.m_destPoly.push(new i.IntPoint(i.ClipperOffset.Round(this.m_srcPoly[e].X+this.m_delta*(this.m_normals[e].X+this.m_normals[e].Y*n)),i.ClipperOffset.Round(this.m_srcPoly[e].Y+this.m_delta*(this.m_normals[e].Y-this.m_normals[e].X*n))))};i.ClipperOffset.prototype.DoMiter=function(e,t,n){var r=this.m_delta/n;this.m_destPoly.push(new i.IntPoint(i.ClipperOffset.Round(this.m_srcPoly[e].X+(this.m_normals[t].X+this.m_normals[e].X)*r),i.ClipperOffset.Round(this.m_srcPoly[e].Y+(this.m_normals[t].Y+this.m_normals[e].Y)*r)))};i.ClipperOffset.prototype.DoRound=function(e,t){var n=Math.atan2(this.m_sinA,this.m_normals[t].X*this.m_normals[e].X+this.m_normals[t].Y*this.m_normals[e].Y);var r=i.Cast_Int32(i.ClipperOffset.Round(this.m_StepsPerRad*Math.abs(n)));var s=this.m_normals[t].X,o=this.m_normals[t].Y,u;for(var a=0;a<r;++a){this.m_destPoly.push(new i.IntPoint(i.ClipperOffset.Round(this.m_srcPoly[e].X+s*this.m_delta),i.ClipperOffset.Round(this.m_srcPoly[e].Y+o*this.m_delta)));u=s;s=s*this.m_cos-this.m_sin*o;o=u*this.m_sin+o*this.m_cos}this.m_destPoly.push(new i.IntPoint(i.ClipperOffset.Round(this.m_srcPoly[e].X+this.m_normals[e].X*this.m_delta),i.ClipperOffset.Round(this.m_srcPoly[e].Y+this.m_normals[e].Y*this.m_delta)))};i.Error=function(e){try{throw new Error(e)}catch(t){alert(t.message)}};i.JS={};i.JS.AreaOfPolygon=function(e,t){if(!t)t=1;return i.Clipper.Area(e)/(t*t)};i.JS.AreaOfPolygons=function(e,t){if(!t)t=1;var n=0;for(var r=0;r<e.length;r++){n+=i.Clipper.Area(e[r])}return n/(t*t)};i.JS.BoundsOfPath=function(e,t){return i.JS.BoundsOfPaths([e],t)};i.JS.BoundsOfPaths=function(e,t){if(!t)t=1;var n=i.Clipper.GetBounds(e);n.left/=t;n.bottom/=t;n.right/=t;n.top/=t;return n};i.JS.Clean=function(e,t){if(!(e instanceof Array))return[];var n=e[0]instanceof Array;var e=i.JS.Clone(e);if(typeof t!="number"||t===null){i.Error("Delta is not a number in Clean().");return e}if(e.length===0||e.length==1&&e[0].length===0||t<0)return e;if(!n)e=[e];var r=e.length;var s,o,u,a,f,l,c;var h=[];for(var p=0;p<r;p++){o=e[p];s=o.length;if(s===0)continue;else if(s<3){u=o;h.push(u);continue}u=o;a=t*t;f=o[0];l=1;for(c=1;c<s;c++){if((o[c].X-f.X)*(o[c].X-f.X)+(o[c].Y-f.Y)*(o[c].Y-f.Y)<=a)continue;u[l]=o[c];f=o[c];l++}f=o[l-1];if((o[0].X-f.X)*(o[0].X-f.X)+(o[0].Y-f.Y)*(o[0].Y-f.Y)<=a)l--;if(l<s)u.splice(l,s-l);if(u.length)h.push(u)}if(!n&&h.length)h=h[0];else if(!n&&h.length===0)h=[];else if(n&&h.length===0)h=[[]];return h};i.JS.Clone=function(e){if(!(e instanceof Array))return[];if(e.length===0)return[];else if(e.length==1&&e[0].length===0)return[[]];var t=e[0]instanceof Array;if(!t)e=[e];var n=e.length,r,i,s,o;var u=new Array(n);for(i=0;i<n;i++){r=e[i].length;o=new Array(r);for(s=0;s<r;s++){o[s]={X:e[i][s].X,Y:e[i][s].Y}}u[i]=o}if(!t)u=u[0];return u};i.JS.Lighten=function(e,t){if(!(e instanceof Array))return[];if(typeof t!="number"||t===null){i.Error("Tolerance is not a number in Lighten().");return i.JS.Clone(e)}if(e.length===0||e.length==1&&e[0].length===0||t<0){return i.JS.Clone(e)}if(!(e[0]instanceof Array))e=[e];var n,r,s,o,u,a,f,l,c,h,p,d;var v,m,g,y,b;var w=e.length;var E=t*t;var S=[];for(n=0;n<w;n++){s=e[n];a=s.length;if(a==0)continue;for(o=0;o<1e6;o++){u=[];a=s.length;if(s[a-1].X!=s[0].X||s[a-1].Y!=s[0].Y){d=1;s.push({X:s[0].X,Y:s[0].Y});a=s.length}else d=0;p=[];for(r=0;r<a-2;r++){f=s[r];c=s[r+1];l=s[r+2];y=f.X;b=f.Y;v=l.X-y;m=l.Y-b;if(v!==0||m!==0){g=((c.X-y)*v+(c.Y-b)*m)/(v*v+m*m);if(g>1){y=l.X;b=l.Y}else if(g>0){y+=v*g;b+=m*g}}v=c.X-y;m=c.Y-b;h=v*v+m*m;if(h<=E){p[r+1]=1;r++}}u.push({X:s[0].X,Y:s[0].Y});for(r=1;r<a-1;r++)if(!p[r])u.push({X:s[r].X,Y:s[r].Y});u.push({X:s[a-1].X,Y:s[a-1].Y});if(d)s.pop();if(!p.length)break;else s=u}a=u.length;if(u[a-1].X==u[0].X&&u[a-1].Y==u[0].Y){u.pop()}if(u.length>2)S.push(u)}if(!e[0]instanceof Array)S=S[0];if(typeof S=="undefined")S=[[]];return S};i.JS.PerimeterOfPath=function(e,t,n){if(typeof e=="undefined")return 0;var r=Math.sqrt;var i=0;var s,o,u=0,a=0,f=0,l=0;var c=e.length;if(c<2)return 0;if(t){e[c]=e[0];c++}while(--c){s=e[c];u=s.X;a=s.Y;o=e[c-1];f=o.X;l=o.Y;i+=r((u-f)*(u-f)+(a-l)*(a-l))}if(t)e.pop();return i/n};i.JS.PerimeterOfPaths=function(e,t,n){if(!n)n=1;var r=0;for(var s=0;s<e.length;s++){r+=i.JS.PerimeterOfPath(e[s],t,n)}return r};i.JS.ScaleDownPath=function(e,t){var n,r;if(!t)t=1;n=e.length;while(n--){r=e[n];r.X=r.X/t;r.Y=r.Y/t}};i.JS.ScaleDownPaths=function(e,t){var n,r,i,s=Math.round;if(!t)t=1;n=e.length;while(n--){r=e[n].length;while(r--){i=e[n][r];i.X=i.X/t;i.Y=i.Y/t}}};i.JS.ScaleUpPath=function(e,t){var n,r,i=Math.round;if(!t)t=1;n=e.length;while(n--){r=e[n];r.X=i(r.X*t);r.Y=i(r.Y*t)}};i.JS.ScaleUpPaths=function(e,t){var n,r,i,s=Math.round;if(!t)t=1;n=e.length;while(n--){r=e[n].length;while(r--){i=e[n][r];i.X=s(i.X*t);i.Y=s(i.Y*t)}}};i.ExPolygons=function(){return[]};i.ExPolygon=function(){this.outer=null;this.holes=null};i.JS.AddOuterPolyNodeToExPolygons=function(e,t){var n=new i.ExPolygon;n.outer=e.Contour();var r=e.Childs();var s=r.length;n.holes=new Array(s);var o,u,a,f,l,c;for(a=0;a<s;a++){o=r[a];n.holes[a]=o.Contour();for(f=0,l=o.Childs(),c=l.length;f<c;f++){u=l[f];i.JS.AddOuterPolyNodeToExPolygons(u,t)}}t.push(n)};i.JS.ExPolygonsToPaths=function(e){var t,n,r,s;var o=new i.Paths;for(t=0,r=e.length;t<r;t++){o.push(e[t].outer);for(n=0,s=e[t].holes.length;n<s;n++){o.push(e[t].holes[n])}}return o};i.JS.PolyTreeToExPolygons=function(e){var t=new i.ExPolygons;var n,r,s,o;for(r=0,s=e.Childs(),o=s.length;r<o;r++){n=s[r];i.JS.AddOuterPolyNodeToExPolygons(n,t)}return t};return{ClipperLib:i}})